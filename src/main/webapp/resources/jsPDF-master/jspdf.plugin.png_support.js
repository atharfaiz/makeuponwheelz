!function(r){"use strict";var e=function(){return"function"!=typeof PNG||"function"!=typeof FlateStream},t=function(e){return e!==r.image_compression.NONE&&n()},n=function(){var r="function"==typeof Deflater;if(!r)throw new Error("requires deflate.js for compression");return r},i=function(e,t,n,i){var f=5,g=u;switch(i){case r.image_compression.FAST:f=3,g=l;break;case r.image_compression.MEDIUM:f=6,g=h;break;case r.image_compression.SLOW:f=9,g=c}e=s(e,t,n,g);var y=new Uint8Array(o(f)),d=a(e),p=new Deflater(f),w=p.append(e),A=p.flush(),v=y.length+w.length+A.length,B=new Uint8Array(v+4);return B.set(y),B.set(w,y.length),B.set(A,y.length+w.length),B[v++]=d>>>24&255,B[v++]=d>>>16&255,B[v++]=d>>>8&255,B[v++]=255&d,r.arrayBufferToBinaryString(B)},o=function(r,e){var t=8,n=Math.LOG2E*Math.log(32768)-8,i=n<<4|t,o=i<<8,a=Math.min(3,(e-1&255)>>1);return o|=a<<6,o|=0,o+=31-o%31,[i,255&o&255]},a=function(r,e){for(var t,n=1,i=65535&n,o=n>>>16&65535,a=r.length,s=0;a>0;){t=a>e?e:a,a-=t;do i+=r[s++],o+=i;while(--t);i%=65521,o%=65521}return(o<<16|i)>>>0},s=function(r,e,t,n){for(var i,o,a,s=r.length/e,f=new Uint8Array(r.length+s),l=y(),u=0;s>u;u++){if(a=u*e,i=r.subarray(a,a+e),n)f.set(n(i,t,o),a+u);else{for(var h=0,c=l.length,g=[];c>h;h++)g[h]=l[h](i,t,o);var p=d(g.concat());f.set(g[p],a+u)}o=i}return f},f=function(r,e,t){var n=Array.apply([],r);return n.unshift(0),n},l=function(r,e,t){var n,i=[],o=0,a=r.length;for(i[0]=1;a>o;o++)n=r[o-e]||0,i[o+1]=r[o]-n+256&255;return i},u=function(r,e,t){var n,i=[],o=0,a=r.length;for(i[0]=2;a>o;o++)n=t&&t[o]||0,i[o+1]=r[o]-n+256&255;return i},h=function(r,e,t){var n,i,o=[],a=0,s=r.length;for(o[0]=3;s>a;a++)n=r[a-e]||0,i=t&&t[a]||0,o[a+1]=r[a]+256-(n+i>>>1)&255;return o},c=function(r,e,t){var n,i,o,a,s=[],f=0,l=r.length;for(s[0]=4;l>f;f++)n=r[f-e]||0,i=t&&t[f]||0,o=t&&t[f-e]||0,a=g(n,i,o),s[f+1]=r[f]-a+256&255;return s},g=function(r,e,t){var n=r+e-t,i=Math.abs(n-r),o=Math.abs(n-e),a=Math.abs(n-t);return o>=i&&a>=i?r:a>=o?e:t},y=function(){return[f,l,u,h,c]},d=function(r){for(var e,t,n,i=0,o=r.length;o>i;)e=p(r[i].slice(1)),(t>e||!t)&&(t=e,n=i),i++;return n},p=function(r){for(var e=0,t=r.length,n=0;t>e;)n+=Math.abs(r[e++]);return n};r.processPNG=function(r,n,o,a,s){var f,l,u,h,c,g,y=this.color_spaces.DEVICE_RGB,d=this.decode.FLATE_DECODE,p=8;if(this.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.isArrayBufferView(r)){if(e())throw new Error("PNG support requires png.js and zlib.js");if(f=new PNG(r),r=f.imgData,p=f.bits,y=f.colorSpace,h=f.colors,-1!==[4,6].indexOf(f.colorType)){if(8===f.bits)for(var w,A,v=32==f.pixelBitlength?new Uint32Array(f.decodePixels().buffer):16==f.pixelBitlength?new Uint16Array(f.decodePixels().buffer):new Uint8Array(f.decodePixels().buffer),B=v.length,m=new Uint8Array(B*f.colors),b=new Uint8Array(B),E=f.pixelBitlength-f.bits,P=0,x=0;B>P;P++){for(w=v[P],A=0;E>A;)m[x++]=w>>>A&255,A+=f.bits;b[P]=w>>>A&255}if(16===f.bits){for(var w,v=new Uint32Array(f.decodePixels().buffer),B=v.length,m=new Uint8Array(B*(32/f.pixelBitlength)*f.colors),b=new Uint8Array(B*(32/f.pixelBitlength)),U=f.colors>1,P=0,x=0,D=0;B>P;)w=v[P++],m[x++]=w>>>0&255,U&&(m[x++]=w>>>16&255,w=v[P++],m[x++]=w>>>0&255),b[D++]=w>>>16&255;p=8}t(a)?(r=i(m,f.width*f.colors,f.colors,a),g=i(b,f.width,1,a)):(r=m,g=b,d=null)}if(3===f.colorType&&(y=this.color_spaces.INDEXED,c=f.palette,f.transparency.indexed)){for(var C=f.transparency.indexed,M=0,P=0,B=C.length;B>P;++P)M+=C[P];if(M/=255,M===B-1&&-1!==C.indexOf(0))u=[C.indexOf(0)];else if(M!==B){for(var v=f.decodePixels(),b=new Uint8Array(v.length),P=0,B=v.length;B>P;P++)b[P]=C[v[P]];g=i(b,f.width,1)}}return l=d===this.decode.FLATE_DECODE?"/Predictor 15 /Colors "+h+" /BitsPerComponent "+p+" /Columns "+f.width:"/Colors "+h+" /BitsPerComponent "+p+" /Columns "+f.width,(this.isArrayBuffer(r)||this.isArrayBufferView(r))&&(r=this.arrayBufferToBinaryString(r)),(g&&this.isArrayBuffer(g)||this.isArrayBufferView(g))&&(g=this.arrayBufferToBinaryString(g)),this.createImageInfo(r,f.width,f.height,y,p,d,n,o,l,u,c,g)}throw new Error("Unsupported PNG image data, try using JPEG instead.")}}(jsPDF.API);