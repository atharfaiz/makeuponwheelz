!function(t,e){function n(e){t.extend(!0,yt,e)}function r(n,r,l){function u(t){G?(S(),C(),R(),D(t)):f()}function f(){K=r.theme?"ui":"fc",n.addClass("fc"),n.addClass(r.isRTL?"fc-rtl":"fc-ltr"),r.theme&&n.addClass("ui-widget"),G=t("<div class='fc-content' style='position:relative'/>").prependTo(n),$=new a(Z,r),Q=$.render(),Q&&n.prepend(Q),y(r.defaultView),t(window).resize(E),m()||v()}function v(){setTimeout(function(){!tt.start&&m()&&D()},0)}function h(){t(window).unbind("resize",E),$.destroy(),G.remove(),n.removeClass("fc fc-rtl ui-widget")}function g(){return 0!==st.offsetWidth}function m(){return 0!==t("body")[0].offsetWidth}function y(e){if(!tt||e!=tt.name){ut++,N();var n,r=tt;r?((r.beforeHide||q)(),I(G,G.height()),r.element.hide()):I(G,1),G.css("overflow","hidden"),tt=ct[e],tt?tt.element.show():tt=ct[e]=new wt[e](n=rt=t("<div class='fc-view fc-view-"+e+"' style='position:absolute'/>").appendTo(G),Z),r&&$.deactivateButton(r.name),$.activateButton(e),D(),G.css("overflow",""),r&&I(G,1),n||(tt.afterShow||q)(),ut--}}function D(t){if(g()){ut++,N(),nt===e&&S();var r=!1;!tt.start||t||ft<tt.start||ft>=tt.end?(tt.render(ft,t||0),x(!0),r=!0):tt.sizeDirty?(tt.clearEvents(),x(),r=!0):tt.eventsDirty&&(tt.clearEvents(),r=!0),tt.sizeDirty=!1,tt.eventsDirty=!1,T(r),et=n.outerWidth(),$.updateTitle(tt.title);var a=new Date;a>=tt.start&&a<tt.end?$.disableButton("today"):$.enableButton("today"),ut--,tt.trigger("viewDisplay",st)}}function M(){C(),g()&&(S(),x(),N(),tt.clearEvents(),tt.renderEvents(dt),tt.sizeDirty=!1)}function C(){t.each(ct,function(t,e){e.sizeDirty=!0})}function S(){nt=r.contentHeight?r.contentHeight:r.height?r.height-(Q?Q.height():0)-W(G):Math.round(G.width()/Math.max(r.aspectRatio,.5))}function x(t){ut++,tt.setHeight(nt,t),rt&&(rt.css("position","relative"),rt=null),tt.setWidth(G.width(),t),ut--}function E(){if(!ut)if(tt.start){var t=++lt;setTimeout(function(){t==lt&&!ut&&g()&&et!=(et=n.outerWidth())&&(ut++,M(),tt.trigger("windowResize",st),ut--)},200)}else v()}function T(t){!r.lazyFetching||it(tt.visStart,tt.visEnd)?k():t&&F()}function k(){ot(tt.visStart,tt.visEnd)}function z(t){dt=t,F()}function H(t){F(t)}function F(t){R(),g()&&(tt.clearEvents(),tt.renderEvents(dt,t),tt.eventsDirty=!1)}function R(){t.each(ct,function(t,e){e.eventsDirty=!0})}function L(t,n,r){tt.select(t,n,r===e?!0:r)}function N(){tt&&tt.unselect()}function A(){D(-1)}function O(){D(1)}function _(){o(ft,-1),D()}function B(){o(ft,1),D()}function j(){ft=new Date,D()}function Y(t,e,n){t instanceof Date?ft=d(t):p(ft,t,e,n),D()}function P(t,n,r){t!==e&&o(ft,t),n!==e&&s(ft,n),r!==e&&c(ft,r),D()}function J(){return d(ft)}function V(){return tt}function X(t,n){return n===e?r[t]:void(("height"==t||"contentHeight"==t||"aspectRatio"==t)&&(r[t]=n,M()))}function U(t,e){return r[t]?r[t].apply(e||st,Array.prototype.slice.call(arguments,2)):void 0}var Z=this;Z.options=r,Z.render=u,Z.destroy=h,Z.refetchEvents=k,Z.reportEvents=z,Z.reportEventChange=H,Z.rerenderEvents=F,Z.changeView=y,Z.select=L,Z.unselect=N,Z.prev=A,Z.next=O,Z.prevYear=_,Z.nextYear=B,Z.today=j,Z.gotoDate=Y,Z.incrementDate=P,Z.formatDate=function(t,e){return b(t,e,r)},Z.formatDates=function(t,e,n){return w(t,e,n,r)},Z.getDate=J,Z.getView=V,Z.option=X,Z.trigger=U,i.call(Z,r,l);var $,Q,G,K,tt,et,nt,rt,at,it=Z.isFetchNeeded,ot=Z.fetchEvents,st=n[0],ct={},lt=0,ut=0,ft=new Date,dt=[];p(ft,r.year,r.month,r.date),r.droppable&&t(document).bind("dragstart",function(e,n){var a=e.target,i=t(a);if(!i.parents(".fc").length){var o=r.dropAccept;(t.isFunction(o)?o.call(a,i):i.is(o))&&(at=a,tt.dragStart(at,e,n))}}).bind("dragstop",function(t,e){at&&(tt.dragStop(at,t,e),at=null)})}function a(e,n){function r(){d=n.theme?"ui":"fc";var e=n.header;return e?v=t("<table class='fc-header' style='width:100%'/>").append(t("<tr/>").append(i("left")).append(i("center")).append(i("right"))):void 0}function a(){v.remove()}function i(r){var a=t("<td class='fc-header-"+r+"'/>"),i=n.header[r];return i&&t.each(i.split(" "),function(r){r>0&&a.append("<span class='fc-header-space'/>");var i;t.each(this.split(","),function(r,o){if("title"==o)a.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),i&&i.addClass(d+"-corner-right"),i=null;else{var s;if(e[o]?s=e[o]:wt[o]&&(s=function(){u.removeClass(d+"-state-hover"),e.changeView(o)}),s){var c=n.theme?J(n.buttonIcons,o):null,l=J(n.buttonText,o),u=t("<span class='fc-button fc-button-"+o+" "+d+"-state-default'>"+(c?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+c+"'/></span>":l)+"</span>").click(function(){u.hasClass(d+"-state-disabled")||s()}).mousedown(function(){u.not("."+d+"-state-active").not("."+d+"-state-disabled").addClass(d+"-state-down")}).mouseup(function(){u.removeClass(d+"-state-down")}).hover(function(){u.not("."+d+"-state-active").not("."+d+"-state-disabled").addClass(d+"-state-hover")},function(){u.removeClass(d+"-state-hover").removeClass(d+"-state-down")}).appendTo(a);U(u),i||u.addClass(d+"-corner-left"),i=u}}}),i&&i.addClass(d+"-corner-right")}),a}function o(t){v.find("h2").html(t)}function s(t){v.find("span.fc-button-"+t).addClass(d+"-state-active")}function c(t){v.find("span.fc-button-"+t).removeClass(d+"-state-active")}function l(t){v.find("span.fc-button-"+t).addClass(d+"-state-disabled")}function u(t){v.find("span.fc-button-"+t).removeClass(d+"-state-disabled")}var f=this;f.render=r,f.destroy=a,f.updateTitle=o,f.activateButton=s,f.deactivateButton=c,f.disableButton=l,f.enableButton=u;var d,v=t([])}function i(n,r){function a(t,e){return!S||S>t||e>x}function i(t,e){S=t,x=e,N=[];var n=++F,r=H.length;R=r;for(var a=0;r>a;a++)o(H[a],n)}function o(e,r){s(e,function(a){if(r==F){if(a){n.eventDataTransform&&(a=t.map(a,n.eventDataTransform)),e.eventDataTransform&&(a=t.map(a,e.eventDataTransform));for(var i=0;i<a.length;i++)a[i].source=e,D(a[i]);N=N.concat(a)}R--,R||k(N)}})}function s(e,r){var a,i,o=bt.sourceFetchers;for(a=0;a<o.length;a++){if(i=o[a](e,S,x,r),i===!0)return;if("object"==typeof i)return void s(i,r)}var c=e.events;if(c)t.isFunction(c)?(p(),c(d(S),d(x),function(t){r(t),y()})):t.isArray(c)?r(c):r();else{var l=e.url;if(l){var u=e.success,f=e.error,v=e.complete,h=t.extend({},e.data||{}),g=K(e.startParam,n.startParam),m=K(e.endParam,n.endParam);g&&(h[g]=Math.round(+S/1e3)),m&&(h[m]=Math.round(+x/1e3)),p(),t.ajax(t.extend({},Mt,e,{data:h,success:function(e){e=e||[];var n=G(u,this,arguments);t.isArray(n)&&(e=n),r(e)},error:function(){G(f,this,arguments),r()},complete:function(){G(v,this,arguments),y()}}))}else r()}}function c(t){t=l(t),t&&(R++,o(t,F))}function l(e){return t.isFunction(e)||t.isArray(e)?e={events:e}:"string"==typeof e&&(e={url:e}),"object"==typeof e?(b(e),H.push(e),e):void 0}function u(e){H=t.grep(H,function(t){return!w(t,e)}),N=t.grep(N,function(t){return!w(t.source,e)}),k(N)}function f(t){var e,n,r=N.length,a=T().defaultEventEnd,i=t.start-t._start,o=t.end?t.end-(t._end||a(t)):0;for(e=0;r>e;e++)n=N[e],n._id==t._id&&n!=t&&(n.start=new Date(+n.start+i),t.end?n.end?n.end=new Date(+n.end+o):n.end=new Date(+a(n)+o):n.end=null,n.title=t.title,n.url=t.url,n.allDay=t.allDay,n.className=t.className,n.editable=t.editable,n.color=t.color,n.backgroudColor=t.backgroudColor,n.borderColor=t.borderColor,n.textColor=t.textColor,D(n));D(t),k(N)}function v(t,e){D(t),t.source||(e&&(z.events.push(t),t.source=z),N.push(t)),k(N)}function h(e){if(e){if(!t.isFunction(e)){var n=e+"";e=function(t){return t._id==n}}N=t.grep(N,e,!0);for(var r=0;r<H.length;r++)t.isArray(H[r].events)&&(H[r].events=t.grep(H[r].events,e,!0))}else{N=[];for(var r=0;r<H.length;r++)t.isArray(H[r].events)&&(H[r].events=[])}k(N)}function g(e){return t.isFunction(e)?t.grep(N,e):e?(e+="",t.grep(N,function(t){return t._id==e})):N}function p(){L++||E("loading",null,!0)}function y(){--L||E("loading",null,!1)}function D(t){var r=t.source||{},a=K(r.ignoreTimezone,n.ignoreTimezone);t._id=t._id||(t.id===e?"_fc"+Ct++:t.id+""),t.date&&(t.start||(t.start=t.date),delete t.date),t._start=d(t.start=m(t.start,a)),t.end=m(t.end,a),t.end&&t.end<=t.start&&(t.end=null),t._end=t.end?d(t.end):null,t.allDay===e&&(t.allDay=K(r.allDayDefault,n.allDayDefault)),t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[]}function b(t){t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[];for(var e=bt.sourceNormalizers,n=0;n<e.length;n++)e[n](t)}function w(t,e){return t&&e&&M(t)==M(e)}function M(t){return("object"==typeof t?t.events||t.url:"")||t}var C=this;C.isFetchNeeded=a,C.fetchEvents=i,C.addEventSource=c,C.removeEventSource=u,C.updateEvent=f,C.renderEvent=v,C.removeEvents=h,C.clientEvents=g,C.normalizeEvent=D;for(var S,x,E=C.trigger,T=C.getView,k=C.reportEvents,z={events:[]},H=[z],F=0,R=0,L=0,N=[],A=0;A<r.length;A++)l(r[A])}function o(t,e,n){return t.setFullYear(t.getFullYear()+e),n||f(t),t}function s(t,e,n){if(+t){var r=t.getMonth()+e,a=d(t);for(a.setDate(1),a.setMonth(r),t.setMonth(r),n||f(t);t.getMonth()!=a.getMonth();)t.setDate(t.getDate()+(a>t?1:-1))}return t}function c(t,e,n){if(+t){var r=t.getDate()+e,a=d(t);a.setHours(9),a.setDate(r),t.setDate(r),n||f(t),l(t,a)}return t}function l(t,e){if(+t)for(;t.getDate()!=e.getDate();)t.setTime(+t+(e>t?1:-1)*Et)}function u(t,e){return t.setMinutes(t.getMinutes()+e),t}function f(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function d(t,e){return e?f(new Date(+t)):new Date(+t)}function v(){var t,e=0;do t=new Date(1970,e++,1);while(t.getHours());return t}function h(t,e,n){for(e=e||1;!t.getDay()||n&&1==t.getDay()||!n&&6==t.getDay();)c(t,e);return t}function g(t,e){return Math.round((d(t,!0)-d(e,!0))/xt)}function p(t,n,r,a){n!==e&&n!=t.getFullYear()&&(t.setDate(1),t.setMonth(0),t.setFullYear(n)),r!==e&&r!=t.getMonth()&&(t.setDate(1),t.setMonth(r)),a!==e&&t.setDate(a)}function m(t,n){return"object"==typeof t?t:"number"==typeof t?new Date(1e3*t):"string"==typeof t?t.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(t)):(n===e&&(n=!0),y(t,n)||(t?new Date(t):null)):null}function y(t,e){var n=t.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var r=new Date(n[1],0,1);if(e||!n[13]){var a=new Date(n[1],0,1,9,0);n[3]&&(r.setMonth(n[3]-1),a.setMonth(n[3]-1)),n[5]&&(r.setDate(n[5]),a.setDate(n[5])),l(r,a),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(1e3*Number("0."+n[12])),l(r,a)}else if(r.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),r.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var i=60*Number(n[16])+(n[18]?Number(n[18]):0);i*="-"==n[15]?1:-1,r=new Date(+r+60*i*1e3)}return r}function D(t){if("number"==typeof t)return 60*t;if("object"==typeof t)return 60*t.getHours()+t.getMinutes();var e=t.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(e){var n=parseInt(e[1],10);return e[3]&&(n%=12,"p"==e[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(e[2]?parseInt(e[2],10):0)}}function b(t,e,n){return w(t,null,e,n)}function w(t,e,n,r){r=r||yt;var a,i,o,s,c=t,l=e,u=n.length,f="";for(a=0;u>a;a++)if(i=n.charAt(a),"'"==i){for(o=a+1;u>o;o++)if("'"==n.charAt(o)){c&&(f+=o==a+1?"'":n.substring(a+1,o),a=o);break}}else if("("==i){for(o=a+1;u>o;o++)if(")"==n.charAt(o)){var d=b(c,n.substring(a+1,o),r);parseInt(d.replace(/\D/,""),10)&&(f+=d),a=o;break}}else if("["==i){for(o=a+1;u>o;o++)if("]"==n.charAt(o)){var v=n.substring(a+1,o),d=b(c,v,r);d!=b(l,v,r)&&(f+=d),a=o;break}}else if("{"==i)c=e,l=t;else if("}"==i)c=t,l=e;else{for(o=u;o>a;o--)if(s=kt[n.substring(a,o)]){c&&(f+=s(c,r)),a=o-1;break}o==a&&c&&(f+=i)}return f}function M(t){var e,n=new Date(t.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),e=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((e-n)/864e5)/7)+1}function C(t){return t.end?S(t.end,t.allDay):c(d(t.start),1)}function S(t,e){return t=d(t),e||t.getHours()||t.getMinutes()?c(t,1):f(t)}function x(t,e){return 100*(e.msLength-t.msLength)+(t.event.start-e.event.start)}function E(t,e){return t.end>e.start&&t.start<e.end}function T(t,e,n,r){var a,i,o,s,c,l,u,f,v=[],h=t.length;for(a=0;h>a;a++)i=t[a],o=i.start,s=e[a],s>n&&r>o&&(n>o?(c=d(n),u=!1):(c=o,u=!0),s>r?(l=d(r),f=!1):(l=s,f=!0),v.push({event:i,start:c,end:l,isStart:u,isEnd:f,msLength:l-c}));return v.sort(x)}function k(t){var e,n,r,a,i,o=[],s=t.length;for(e=0;s>e;e++){for(n=t[e],r=0;;){if(a=!1,o[r])for(i=0;i<o[r].length;i++)if(E(o[r][i],n)){a=!0;break}if(!a)break;r++}o[r]?o[r].push(n):o[r]=[n]}return o}function z(n,r,a){n.unbind("mouseover").mouseover(function(n){for(var i,o,s,c=n.target;c!=this;)i=c,c=c.parentNode;(o=i._fci)!==e&&(i._fci=e,s=r[o],a(s.event,s.element,s),t(n.target).trigger(n)),n.stopPropagation()})}function H(e,n,r){for(var a,i=0;i<e.length;i++)a=t(e[i]),a.width(Math.max(0,n-R(a,r)))}function F(e,n,r){for(var a,i=0;i<e.length;i++)a=t(e[i]),a.height(Math.max(0,n-W(a,r)))}function R(t,e){return L(t)+A(t)+(e?N(t):0)}function L(e){return(parseFloat(t.css(e[0],"paddingLeft",!0))||0)+(parseFloat(t.css(e[0],"paddingRight",!0))||0)}function N(e){return(parseFloat(t.css(e[0],"marginLeft",!0))||0)+(parseFloat(t.css(e[0],"marginRight",!0))||0)}function A(e){return(parseFloat(t.css(e[0],"borderLeftWidth",!0))||0)+(parseFloat(t.css(e[0],"borderRightWidth",!0))||0)}function W(t,e){return O(t)+B(t)+(e?_(t):0)}function O(e){return(parseFloat(t.css(e[0],"paddingTop",!0))||0)+(parseFloat(t.css(e[0],"paddingBottom",!0))||0)}function _(e){return(parseFloat(t.css(e[0],"marginTop",!0))||0)+(parseFloat(t.css(e[0],"marginBottom",!0))||0)}function B(e){return(parseFloat(t.css(e[0],"borderTopWidth",!0))||0)+(parseFloat(t.css(e[0],"borderBottomWidth",!0))||0)}function I(t,e){e="number"==typeof e?e+"px":e,t.each(function(t,n){n.style.cssText+=";min-height:"+e+";_height:"+e})}function q(){}function j(t,e){return t-e}function Y(t){return Math.max.apply(Math,t)}function P(t){return(10>t?"0":"")+t}function J(t,n){if(t[n]!==e)return t[n];for(var r,a=n.split(/(?=[A-Z])/),i=a.length-1;i>=0;i--)if(r=t[a[i].toLowerCase()],r!==e)return r;return t[""]}function V(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function X(t){return t.id+"/"+t.className+"/"+t.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/gi,"")}function U(t){t.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function Z(t){t.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function $(t,e){t.each(function(t,n){n.className=n.className.replace(/^fc-\w*/,"fc-"+St[e.getDay()])})}function Q(t,e){var n=t.source||{},r=t.color,a=n.color,i=e("eventColor"),o=t.backgroundColor||r||n.backgroundColor||a||e("eventBackgroundColor")||i,s=t.borderColor||r||n.borderColor||a||e("eventBorderColor")||i,c=t.textColor||n.textColor||e("eventTextColor"),l=[];return o&&l.push("background-color:"+o),s&&l.push("border-color:"+s),c&&l.push("color:"+c),l.join(";")}function G(e,n,r){if(t.isFunction(e)&&(e=[e]),e){var a,i;for(a=0;a<e.length;a++)i=e[a].apply(n,r)||i;return i}}function K(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==e)return arguments[t]}function tt(t,e){function n(t,e){e&&(s(t,e),t.setDate(1));var n=d(t,!0);n.setDate(1);var l=s(d(n),1),u=d(n),f=d(l),v=a("firstDay"),g=a("weekends")?0:1;g&&(h(u),h(f,-1,!0)),c(u,-((u.getDay()-Math.max(v,g)+7)%7)),c(f,(7-f.getDay()+Math.max(v,g))%7);var p=Math.round((f-u)/(7*xt));"fixed"==a("weekMode")&&(c(f,7*(6-p)),p=6),r.title=o(n,a("titleFormat")),r.start=n,r.end=l,r.visStart=u,r.visEnd=f,i(p,g?5:7,!0)}var r=this;r.render=n,rt.call(r,t,e,"month");var a=r.opt,i=r.renderBasic,o=e.formatDate}function et(t,e){function n(t,e){e&&c(t,7*e);var n=c(d(t),-((t.getDay()-a("firstDay")+7)%7)),s=c(d(n),7),l=d(n),u=d(s),f=a("weekends");f||(h(l),h(u,-1,!0)),r.title=o(l,c(d(u),-1),a("titleFormat")),r.start=n,r.end=s,r.visStart=l,r.visEnd=u,i(1,f?7:5,!1)}var r=this;r.render=n,rt.call(r,t,e,"basicWeek");var a=r.opt,i=r.renderBasic,o=e.formatDates}function nt(t,e){function n(t,e){e&&(c(t,e),a("weekends")||h(t,0>e?-1:1)),r.title=o(t,a("titleFormat")),r.start=r.visStart=d(t,!0),r.end=r.visEnd=c(d(r.start),1),i(1,1,!1)}var r=this;r.render=n,rt.call(r,t,e,"basicDay");var a=r.opt,i=r.renderBasic,o=e.formatDate}function rt(e,n,r){function a(t,e,n){nt=t,rt=e,i();var r=!P;r?o():Tt(),s(n)}function i(){ct=xt("isRTL"),ct?(lt=-1,ft=rt-1):(lt=1,ft=0),pt=xt("firstDay"),yt=xt("weekends")?0:1,Dt=xt("theme")?"ui":"fc",bt=xt("columnFormat"),wt=xt("weekNumbers"),Mt=xt("weekNumberTitle"),Ct="iso"!=xt("weekNumberCalculation")?"w":"W"}function o(){Q=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(e)}function s(n){var r,a,i,o,s="",c=Dt+"-widget-header",l=Dt+"-widget-content",u=B.start.getMonth(),d=f(new Date);for(s+="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>",wt&&(s+="<th class='fc-week-number "+c+"'/>"),r=0;rt>r;r++)i=F(0,r),s+="<th class='fc-day-header fc-"+St[i.getDay()]+" "+c+"'/>";for(s+="</tr></thead><tbody>",r=0;nt>r;r++){for(s+="<tr class='fc-week'>",wt&&(s+="<td class='fc-week-number "+l+"'><div/></td>"),a=0;rt>a;a++)i=F(r,a),o=["fc-day","fc-"+St[i.getDay()],l],i.getMonth()!=u&&o.push("fc-other-month"),+i==+d&&(o.push("fc-today"),o.push(Dt+"-state-highlight")),s+="<td class='"+o.join(" ")+"' data-date='"+Ft(i,"yyyy-MM-dd")+"'><div>",n&&(s+="<div class='fc-day-number'>"+i.getDate()+"</div>"),s+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";s+="</tr>"}s+="</tbody></table>",O(),q&&q.remove(),q=t(s).appendTo(e),j=q.find("thead"),Y=j.find(".fc-day-header"),P=q.find("tbody"),J=P.find("tr"),V=P.find(".fc-day"),X=J.find("td:first-child"),$=J.eq(0).find(".fc-day-content > div"),Z(j.add(j.find("tr"))),Z(J),J.eq(0).addClass("fc-first"),J.filter(":last").addClass("fc-last"),wt&&j.find(".fc-week-number").text(Mt),Y.each(function(e,n){var r=R(e);t(n).text(Ft(r,bt))}),wt&&P.find(".fc-week-number > div").each(function(e,n){var r=F(e,0);t(n).text(Ft(r,Ct))}),V.each(function(e,n){var r=R(e);Et("dayRender",B,r,t(n))}),v(V)}function l(e){K=e;var n,r,a,i=K-j.height();"variable"==xt("weekMode")?n=r=Math.floor(i/(1==nt?2:6)):(n=Math.floor(i/nt),r=i-n*(nt-1)),X.each(function(e,i){nt>e&&(a=t(i),I(a.find("> div"),(e==nt-1?r:n)-W(a)))}),_()}function u(t){G=t,st.clear(),et=0,wt&&(et=j.find("th.fc-week-number").outerWidth()),tt=Math.floor((G-et)/rt),H(Y.slice(0,-1),tt)}function v(t){t.click(h).mousedown(Ht)}function h(e){if(!xt("selectable")){var n=y(t(this).data("date"));Et("dayClick",this,n,!0,e)}}function p(t,e,n){n&&it.build();for(var r=d(B.visStart),a=c(d(r),rt),i=0;nt>i;i++){var o=new Date(Math.max(r,t)),s=new Date(Math.min(a,e));if(s>o){var l,u;ct?(l=g(s,r)*lt+ft+1,u=g(o,r)*lt+ft+1):(l=g(o,r),u=g(s,r)),v(m(i,l,i,u-1))}c(r,7),c(a,7)}}function m(t,n,r,a){var i=it.rect(t,n,r,a,e);return kt(i,e)}function D(t,e){return d(t)}function b(t,e,n){p(t,c(d(e),1),!0)}function w(){zt()}function M(t,e,n){var r=k(t),a=V[r.row*rt+r.col];Et("dayClick",a,t,e,n)}function C(t,e,n){ot.start(function(t){zt(),t&&m(t.row,t.col,t.row,t.col)},e)}function S(t,e,n){var r=ot.stop();if(zt(),r){var a=z(r);Et("drop",t,a,!0,e,n)}}function x(t){return d(t.start)}function E(t){return st.left(t)}function T(t){return st.right(t)}function k(t){return{row:Math.floor(g(t,B.visStart)/7),col:L(t.getDay())}}function z(t){return F(t.row,t.col)}function F(t,e){return c(d(B.visStart),7*t+e*lt+ft)}function R(t){return F(Math.floor(t/rt),t%rt)}function L(t){return(t-Math.max(pt,yt)+rt)%rt*lt+ft}function N(t){return J.eq(t)}function A(t){var e=0;return wt&&(e+=et),{left:e,right:G}}function O(){I(e,e.height())}function _(){I(e,1)}var B=this;B.renderBasic=a,B.setHeight=l,B.setWidth=u,B.renderDayOverlay=p,B.defaultSelectionEnd=D,B.renderSelection=b,B.clearSelection=w,B.reportDayClick=M,B.dragStart=C,B.dragStop=S,B.defaultEventEnd=x,B.getHoverListener=function(){return ot},B.colContentLeft=E,B.colContentRight=T,B.dayOfWeekCol=L,B.dateCell=k,B.cellDate=z,B.cellIsAllDay=function(){return!0},B.allDayRow=N,B.allDayBounds=A,B.getRowCnt=function(){return nt},B.getColCnt=function(){return rt},B.getColWidth=function(){return tt},B.getDaySegmentContainer=function(){return Q},ut.call(B,e,n,r),vt.call(B),dt.call(B),at.call(B);var q,j,Y,P,J,V,X,$,Q,G,K,tt,et,nt,rt,it,ot,st,ct,lt,ft,pt,yt,Dt,bt,wt,Mt,Ct,xt=B.opt,Et=B.trigger,Tt=B.clearEvents,kt=B.renderOverlay,zt=B.clearOverlays,Ht=B.daySelectionMousedown,Ft=n.formatDate;U(e.addClass("fc-grid")),it=new ht(function(e,n){var r,a,i;Y.each(function(e,o){r=t(o),a=r.offset().left,e&&(i[1]=a),i=[a],n[e]=i}),i[1]=a+r.outerWidth(),J.each(function(n,o){nt>n&&(r=t(o),a=r.offset().top,n&&(i[1]=a),i=[a],e[n]=i)}),i[1]=a+r.outerHeight()}),ot=new gt(it),st=new mt(function(t){return $.eq(t)})}function at(){function e(t,e){v(t),E(r(t),e),l("eventAfterAllRender")}function n(){h(),D().empty()}function r(e){var n,r,a,i,s,l,u=S(),f=x(),v=d(o.visStart),h=c(d(v),f),g=t.map(e,C),p=[];for(n=0;u>n;n++){for(r=k(T(e,g,v,h)),a=0;a<r.length;a++)for(i=r[a],s=0;s<i.length;s++)l=i[s],l.row=n,l.level=a,p.push(l);c(v,7),c(h,7)}return p}function a(t,e,n){u(t)&&i(t,e),n.isEnd&&f(t)&&z(t,e,n),g(t,e)}function i(e,n){var r,a=b();n.draggable({zIndex:9,delay:50,opacity:s("dragOpacity"),revertDuration:s("dragRevertDuration"),start:function(t,i){l("eventDragStart",n,e,t,i),m(e,n),a.start(function(t,a,i,o){n.draggable("option","revert",!t||!i&&!o),M(),t?(r=7*i+o*(s("isRTL")?-1:1),w(c(d(e.start),r),c(C(e),r))):r=0},t,"drag")},stop:function(i,o){a.stop(),M(),l("eventDragStop",n,e,i,o);for(var s=e.title.indexOf("[")+1,c="";s<e.title.indexOf("]");)c+=e.title[s],s++;if("false"==changeEventDragEtc(c))return eventL(),!1;if("false"==currentuserLoginCheck(c))return eventL(),!1;if("false"==calculateDatetime(r,0,e.start,e.end))return eventL(),!1;if(r){if(!confirm("Do you want to change ?"))return void eventL();minuteDelta=0,t.ajax({url:"/sgterp/protected/addClassAndAudiReservation",type:"POST",data:"reservationId="+c+"&minuteDelta="+minuteDelta+"&dayDelta="+r+"&event=drag",success:function(t){y(this,e,r,0,e.allDay,i,o),eventL()},error:function(t){alert("Internal server problem!"),eventL()}})}else n.css("filter",""),p(e,n)}})}var o=this;o.renderEvents=e,o.compileDaySegs=r,o.clearEvents=n,o.bindDaySeg=a,ft.call(o);var s=o.opt,l=o.trigger,u=o.isEventDraggable,f=o.isEventResizable,v=o.reportEvents,h=o.reportEventClear,g=o.eventElementHandlers,p=o.showEvents,m=o.hideEvents,y=o.eventDrop,D=o.getDaySegmentContainer,b=o.getHoverListener,w=o.renderDayOverlay,M=o.clearOverlays,S=o.getRowCnt,x=o.getColCnt,E=o.renderDaySegs,z=o.resizableDayEvent}function it(t,e){function n(t,e){e&&c(t,7*e);var n=c(d(t),-((t.getDay()-a("firstDay")+7)%7)),s=c(d(n),7),l=d(n),u=d(s),f=a("weekends");f||(h(l),h(u,-1,!0)),r.title=o(l,c(d(u),-1),a("titleFormat")),r.start=n,r.end=s,r.visStart=l,r.visEnd=u,i(f?7:5)}var r=this;r.render=n,st.call(r,t,e,"agendaWeek");var a=r.opt,i=r.renderAgenda,o=e.formatDates}function ot(t,e){function n(t,e){e&&(c(t,e),a("weekends")||h(t,0>e?-1:1));var n=d(t,!0),s=c(d(n),1);r.title=o(t,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=s,i(1)}var r=this;r.render=n,st.call(r,t,e,"agendaDay");var a=r.opt,i=r.renderAgenda,o=e.formatDate}function st(n,r,a){function i(t){Wt=t,o(),tt?ne():s(),l()}function o(){jt=te("theme")?"ui":"fc",Pt=te("weekends")?0:1,Yt=te("firstDay"),(Jt=te("isRTL"))?(Vt=-1,Xt=Wt-1):(Vt=1,Xt=0),Ut=D(te("minTime")),Zt=D(te("maxTime")),$t=te("columnFormat"),Qt=te("weekNumbers"),Gt=te("weekNumberTitle"),Kt="iso"!=te("weekNumberCalculation")?"w":"W",Lt=te("snapMinutes")||te("slotMinutes")}function s(){var e,r,a,i,o,s=jt+"-widget-header",c=jt+"-widget-content",l=te("slotMinutes")%15==0;for(e="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr>",e+=Qt?"<th class='fc-agenda-axis fc-week-number "+s+"'/>":"<th class='fc-agenda-axis "+s+"'>&nbsp;</th>",r=0;Wt>r;r++)e+="<th class='fc- fc-col"+r+" "+s+"'/>";for(e+="<th class='fc-agenda-gutter "+s+"'>&nbsp;</th></tr></thead><tbody><tr><th class='fc-agenda-axis "+s+"'>&nbsp;</th>",r=0;Wt>r;r++)e+="<td class='fc- fc-col"+r+" "+c+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";for(e+="<td class='fc-agenda-gutter "+c+"'>&nbsp;</td></tr></tbody></table>",tt=t(e).appendTo(n),et=tt.find("thead"),nt=et.find("th").slice(1,-1),rt=tt.find("tbody"),at=rt.find("td").slice(0,-1),it=at.find("div.fc-day-content div"),ot=at.eq(0),st=ot.find("> div"),Z(et.add(et.find("tr"))),Z(rt.add(rt.find("tr"))),St=et.find("th:first"),xt=tt.find(".fc-agenda-gutter"),lt=t("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),te("allDaySlot")?(ft=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(lt),e="<table style='width:100%' class='fc-agenda-allday' id='calendarTable' cellspacing='0'><tr><th class='"+s+" fc-agenda-axis'>"+te("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+s+" fc-agenda-gutter'>&nbsp;</th></tr></table>",pt=t(e).appendTo(lt),yt=pt.find("tr"),w(yt.find("td")),St=St.add(pt.find("th:first")),xt=xt.add(pt.find("th.fc-agenda-gutter")),lt.append("<div class='fc-agenda-divider "+s+"'><div class='fc-agenda-divider-inner'/></div>")):ft=t([]),Dt=t("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(lt),bt=t("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(Dt),wt=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(bt),e="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",a=v(),i=u(d(a),Zt),u(a,Ut),Ot=0,r=0;i>a;r++)o=a.getMinutes(),e+="<tr class='fc-slot"+r+" "+(o?"fc-minor":"")+"'><th class='fc-agenda-axis "+s+"'>"+(l&&o?"&nbsp;":le(a,te("axisFormat")))+"</th><td class='"+c+"'><div style='position:relative'>&nbsp;</div></td></tr>",u(a,te("slotMinutes")),Ot++;e+="</tbody></table>",Mt=t(e).appendTo(bt),Ct=Mt.find("div:first"),M(Mt.find("td")),St=St.add(Mt.find("th:first"))}function l(){var t,e,n,r,a=f(new Date);if(Qt){var i=le(L(0),Kt);Jt?i+=Gt:i=Gt+i,et.find(".fc-week-number").text(i)}for(t=0;Wt>t;t++)r=L(t),e=nt.eq(t),e.html(le(r,$t)),n=at.eq(t),+r==+a?n.addClass(jt+"-state-highlight fc-today"):n.removeClass(jt+"-state-highlight fc-today"),$(e.add(n),r)}function h(t,n){t===e&&(t=kt),kt=t,ue={};var r=rt.position().top,a=Dt.position().top,i=Math.min(t-r,Mt.height()+a+1);st.height(i-W(ot)),lt.css("top",r),Dt.height(i-a-1),Rt=Ct.height()+1,Nt=te("slotMinutes")/Lt,At=Rt/Nt,n&&m()}function p(e){Tt=e,It.clear(),zt=0,H(St.width("").each(function(e,n){zt=Math.max(zt,t(n).outerWidth())}),zt);var n=Dt[0].clientWidth;Ft=Dt.width()-n,Ft?(H(xt,Ft),xt.show().prev().removeClass("fc-last")):xt.hide().prev().addClass("fc-last"),Ht=Math.floor((n-zt)/Wt),H(nt.slice(0,-1),Ht)}function m(){function t(){Dt.scrollTop(r)}var e=v(),n=d(e);n.setHours(te("firstHour"));var r=O(e,n)+1;t(),setTimeout(t,0)}function y(){qt=Dt.scrollTop()}function b(){Dt.scrollTop(qt)}function w(t){t.click(C).mousedown(se)}function M(t){t.click(C).mousedown(V)}function C(t){if(!te("selectable")){var e=Math.min(Wt-1,Math.floor((t.pageX-tt.offset().left-zt)/Ht)),n=L(e),r=this.parentNode.className.match(/fc-slot(\d+)/);if(r){var a=parseInt(r[1])*te("slotMinutes"),i=Math.floor(a/60);n.setHours(i),n.setMinutes(a%60+Ut),ee("dayClick",at[e],n,!1,t)}else ee("dayClick",at[e],n,!0,t)}}function S(t,e,n){n&&_t.build();var r,a,i=d(K.visStart);Jt?(r=g(e,i)*Vt+Xt+1,a=g(t,i)*Vt+Xt+1):(r=g(t,i),a=g(e,i)),r=Math.max(0,r),a=Math.min(Wt,a),a>r&&w(x(0,r,0,a-1))}function x(t,e,n,r){var a=_t.rect(t,e,n,r,lt);return re(a,lt)}function E(t,e){for(var n=d(K.visStart),r=c(d(n),1),a=0;Wt>a;a++){var i=new Date(Math.max(n,t)),o=new Date(Math.min(r,e));if(o>i){var s=a*Vt+Xt,l=_t.rect(0,s,0,s,bt),u=O(n,i),f=O(n,o);l.top=u,l.height=f-u,M(re(l,bt))}c(n,1),c(r,1)}}function T(t){return It.left(t)}function k(t){return It.right(t)}function z(t){return{row:Math.floor(g(t,K.visStart)/7),col:A(t.getDay())}}function R(t){var e=L(t.col),n=t.row;return te("allDaySlot")&&n--,n>=0&&u(e,Ut+n*Lt),e}function L(t){return c(d(K.visStart),t*Vt+Xt)}function N(t){return te("allDaySlot")&&!t.row}function A(t){return(t-Math.max(Yt,Pt)+Wt)%Wt*Vt+Xt}function O(t,n){if(t=d(t,!0),n<u(d(t),Ut))return 0;if(n>=u(d(t),Zt))return Mt.height();var r=te("slotMinutes"),a=60*n.getHours()+n.getMinutes()-Ut,i=Math.floor(a/r),o=ue[i];return o===e&&(o=ue[i]=Mt.find("tr:eq("+i+") td div")[0].offsetTop),Math.max(0,Math.round(o-1+Rt*(a%r/r)))}function _(){return{left:zt,right:Tt-Ft}}function B(t){return yt}function I(t){var e=d(t.start);return t.allDay?e:u(e,te("defaultEventMinutes"))}function q(t,e){return e?d(t):u(d(t),te("slotMinutes"))}function Y(t,e,n){n?te("allDaySlot")&&S(t,c(d(e),1),!0):P(t,e)}function P(e,n){var r=te("selectHelper");if(_t.build(),r){var a=g(e,K.visStart)*Vt+Xt;if(a>=0&&Wt>a){var i=_t.rect(0,a,0,a,bt),o=O(e,e),s=O(e,n);if(s>o){if(i.top=o,i.height=s-o,i.left+=2,i.width-=5,t.isFunction(r)){var c=r(e,n);c&&(i.position="absolute",i.zIndex=8,Et=t(c).css(i).appendTo(bt))}else i.isStart=!0,i.isEnd=!0,Et=t(ce({title:"",start:e,end:n,className:["fc-select-helper"],editable:!1},i)),Et.css("opacity",te("dragOpacity"));Et&&(M(Et),bt.append(Et),H(Et,i.width,!0),F(Et,i.height,!0))}}}else E(e,n)}function J(){ae(),Et&&(Et.remove(),Et=null)}function V(e){if(1==e.which&&te("selectable")){oe(e);var n;Bt.start(function(t,e){if(J(),t&&t.col==e.col&&!N(t)){var r=R(e),a=R(t);n=[r,u(d(r),Lt),a,u(d(a),Lt)].sort(j),P(n[0],n[3])}else n=null},e),t(document).one("mouseup",function(t){Bt.stop(),n&&(+n[0]==+n[1]&&X(n[0],!1,t),ie(n[0],n[3],!1,t))})}}function X(t,e,n){ee("dayClick",at[A(t.getDay())],t,e,n)}function Q(t,e,n){Bt.start(function(t){if(ae(),t)if(N(t))x(t.row,t.col,t.row,t.col);else{var e=R(t),n=u(d(e),te("defaultEventMinutes"));E(e,n)}},e)}function G(t,e,n){var r=Bt.stop();ae(),r&&ee("drop",t,R(r),N(r),e,n)}var K=this;K.renderAgenda=i,K.setWidth=p,K.setHeight=h,K.beforeHide=y,K.afterShow=b,K.defaultEventEnd=I,K.timePosition=O,K.dayOfWeekCol=A,K.dateCell=z,K.cellDate=R,K.cellIsAllDay=N,K.allDayRow=B,K.allDayBounds=_,K.getHoverListener=function(){return Bt},K.colContentLeft=T,K.colContentRight=k,K.getDaySegmentContainer=function(){return ft},K.getSlotSegmentContainer=function(){return wt},K.getMinMinute=function(){return Ut},K.getMaxMinute=function(){return Zt},K.getBodyContent=function(){return bt},K.getRowCnt=function(){return 1},K.getColCnt=function(){return Wt},K.getColWidth=function(){return Ht},K.getSnapHeight=function(){return At},K.getSnapMinutes=function(){return Lt},K.defaultSelectionEnd=q,K.renderDayOverlay=S,K.renderSelection=Y,K.clearSelection=J,K.reportDayClick=X,K.dragStart=Q,K.dragStop=G,ut.call(K,n,r,a),vt.call(K),dt.call(K),ct.call(K);var tt,et,nt,rt,at,it,ot,st,lt,ft,pt,yt,Dt,bt,wt,Mt,Ct,St,xt,Et,Tt,kt,zt,Ht,Ft,Rt,Lt,Nt,At,Wt,Ot,_t,Bt,It,qt,jt,Yt,Pt,Jt,Vt,Xt,Ut,Zt,$t,Qt,Gt,Kt,te=K.opt,ee=K.trigger,ne=K.clearEvents,re=K.renderOverlay,ae=K.clearOverlays,ie=K.reportSelection,oe=K.unselect,se=K.daySelectionMousedown,ce=K.slotSegHtml,le=r.formatDate,ue={};U(n.addClass("fc-agenda")),_t=new ht(function(e,n){function r(t){return Math.max(c,Math.min(l,t))}var a,i,o;nt.each(function(e,r){a=t(r),i=a.offset().left,e&&(o[1]=i),o=[i],n[e]=o}),o[1]=i+a.outerWidth(),te("allDaySlot")&&(a=yt,i=a.offset().top,e[0]=[i,i+a.outerHeight()]);for(var s=bt.offset().top,c=Dt.offset().top,l=c+Dt.outerHeight(),u=0;Ot*Nt>u;u++)e.push([r(s+At*u),r(s+At*(u+1))])}),Bt=new gt(_t),It=new mt(function(t){return it.eq(t)})}function ct(){function n(t,e){S(t);var n,r=t.length,o=[],c=[];for(n=0;r>n;n++)t[n].allDay?o.push(t[n]):c.push(t[n]);y("allDaySlot")&&(j(a(o),e),H()),s(i(c),e),D("eventAfterAllRender")}function r(){x(),L().empty(),N().empty()}function a(e){var n,r,a,i,o=k(T(e,t.map(e,C),m.visStart,m.visEnd)),s=o.length,c=[];for(n=0;s>n;n++)for(r=o[n],
a=0;a<r.length;a++)i=r[a],i.row=0,i.level=n,c.push(i);return c}function i(e){var n,r,a,i,s,l,f=P(),v=_(),h=O(),g=u(d(m.visStart),v),p=t.map(e,o),y=[];for(n=0;f>n;n++){for(r=k(T(e,p,g,u(d(g),h-v))),lt(r),a=0;a<r.length;a++)for(i=r[a],s=0;s<i.length;s++)l=i[s],l.col=n,l.level=a,y.push(l);c(g,1,!0)}return y}function o(t){return t.end?d(t.end):u(d(t.start),y("defaultEventMinutes"))}function s(n,r){var a,i,o,s,c,u,f,d,h,g,p,m,b,w,M,C,S,x,E,T,k,H,F=n.length,L="",A={},O={},_=N(),j=P();for((T=y("isRTL"))?(k=-1,H=j-1):(k=1,H=0),a=0;F>a;a++)i=n[a],o=i.event,s=B(i.start,i.start),c=B(i.start,i.end),u=i.col,f=i.level,d=i.forward||0,h=I(u*k+H),g=q(u*k+H)-h,g=Math.min(g-6,.95*g),p=f?g/(f+d+1):d?2*(g/(d+1)-6):g,m=h+g/(f+d+1)*f*k+(T?g-p:0),i.top=s,i.left=m,i.outerWidth=p,i.outerHeight=c-s,L+=l(o,i);for(_[0].innerHTML=L,b=_.children(),a=0;F>a;a++)i=n[a],o=i.event,w=t(b[a]),M=D("eventRender",o,o,w),M===!1?w.remove():(M&&M!==!0&&(w.remove(),w=t(M).css({position:"absolute",top:i.top,left:i.left}).appendTo(_)),i.element=w,o._id===r?v(o,w,i):w[0]._fci=a,G(o,w));for(z(_,n,v),a=0;F>a;a++)i=n[a],(w=i.element)&&(S=A[C=i.key=X(w[0])],i.vsides=S===e?A[C]=W(w,!0):S,S=O[C],i.hsides=S===e?O[C]=R(w,!0):S,x=w.find(".fc-event-title"),x.length&&(i.contentTop=x[0].offsetTop));for(a=0;F>a;a++)i=n[a],(w=i.element)&&(w[0].style.width=Math.max(0,i.outerWidth-i.hsides)+"px",E=Math.max(0,i.outerHeight-i.vsides),w[0].style.height=E+"px",o=i.event,i.contentTop!==e&&E-i.contentTop<10&&(w.find("div.fc-event-time").text(ot(o.start,y("timeFormat"))+" - "+o.title),w.find("div.fc-event-title").remove()),D("eventAfterRender",o,o,w))}function l(t,e){var n="<",r=t.url,a=Q(t,y),i=["fc-event","fc-event-vert"];return b(t)&&i.push("fc-event-draggable"),e.isStart&&i.push("fc-event-start"),e.isEnd&&i.push("fc-event-end"),i=i.concat(t.className),t.source&&(i=i.concat(t.source.className||[])),n+=r?"a href='"+V(t.url)+"'":"div",n+=" class='"+i.join(" ")+"' style='position:absolute;z-index:8;top:"+e.top+"px;left:"+e.left+"px;"+a+"'><div class='fc-event-inner'><div class='fc-event-time'>"+V(st(t.start,t.end,y("timeFormat")))+"</div><div class='fc-event-title'>"+V(t.title)+"</div></div><div class='fc-event-bg'></div>",e.isEnd&&w(t)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(r?"a":"div")+">"}function f(t,e,n){b(t)&&h(t,e,n.isStart),n.isEnd&&w(t)&&Y(t,e,n),E(t,e)}function v(t,e,n){var r=e.find("div.fc-event-time");b(t)&&g(t,e,r),n.isEnd&&w(t)&&p(t,e,r),E(t,e)}function h(t,e,n){function r(){s||(e.width(a).height("").draggable("option","grid",null),s=!0)}var a,i,o,s=!0,l=y("isRTL")?-1:1,u=A(),f=J(),v=U(),h=Z(),g=_();e.draggable({zIndex:9,opacity:y("dragOpacity","month"),revertDuration:y("dragRevertDuration"),start:function(g,p){D("eventDragStart",e,t,g,p),tt(t,e),a=e.width(),u.start(function(a,u,g,p){at(),a?(i=!1,o=p*l,a.row?n?s&&(e.width(f-10),F(e,v*Math.round((t.end?(t.end-t.start)/Tt:y("defaultEventMinutes"))/h)),e.draggable("option","grid",[f,1]),s=!1):i=!0:(rt(c(d(t.start),o),c(C(t),o)),r()),i=i||s&&!o):(r(),i=!0),e.draggable("option","revert",i)},g,"drag")},stop:function(n,a){if(u.stop(),at(),D("eventDragStop",e,t,n,a),i)r(),e.css("filter",""),K(t,e);else{var c=0;s||(c=Math.round((e.offset().top-$().offset().top)/v)*h+g-(60*t.start.getHours()+t.start.getMinutes())),et(this,t,o,c,s,n,a)}}})}function g(e,n,r){function a(t){var n,a=u(d(e.start),t);e.end&&(n=u(d(e.end),t)),r.text(st(a,n,y("timeFormat")))}function i(){v&&(r.css("display",""),n.draggable("option","grid",[m,b]),v=!1)}var o,s,l,f,v=!1,h=y("isRTL")?-1:1,g=A(),p=P(),m=J(),b=U(),w=Z();n.draggable({zIndex:9,scroll:!1,grid:[m,b],axis:1==p?"y":!1,opacity:y("dragOpacity"),revertDuration:y("dragRevertDuration"),start:function(t,a){D("eventDragStart",n,e,t,a),tt(e,n),o=n.position(),l=f=0,g.start(function(t,a,o,l){n.draggable("option","revert",!t),at(),t&&(s=l*h,y("allDaySlot")&&!t.row?(v||(v=!0,r.hide(),n.draggable("option","grid",null)),rt(c(d(e.start),s),c(C(e),s))):i())},t,"drag")},drag:function(t,e){l=Math.round((e.position.top-o.top)/b)*w,l!=f&&(v||a(l),f=l)},stop:function(r,c){var u=g.stop();if(at(),D("eventDragStop",n,e,r,c),u&&(s||l||v)){for(var f=e.title.indexOf("[")+1,d="";f<e.title.indexOf("]");)d+=e.title[f],f++;if("false"==changeEventDragEtc(d))return eventL(),!1;if("false"==currentuserLoginCheck(d))return eventL(),!1;if("false"==calculateDatetime(s,l,e.start,e.end))return eventL(),!1;if(!confirm("Do you want to change ?"))return void eventL();t.ajax({url:"/sgterp/protected/addClassAndAudiReservation",type:"POST",data:"reservationId="+d+"&minuteDelta="+l+"&dayDelta="+s+"&event=drag",success:function(t){et(this,e,s,v?0:l,v,r,c),eventL()},error:function(t){alert("Internal server problem!"),eventL()}})}else i(),n.css("filter",""),n.css(o),a(0),K(e,n)}})}function p(t,e,n){var r,a,i=U(),o=Z();e.resizable({handles:{s:".ui-resizable-handle"},grid:i,start:function(n,i){r=a=0,tt(t,e),e.css("z-index",9),D("eventResizeStart",this,t,n,i)},resize:function(s,c){r=Math.round((Math.max(i,e.height())-c.originalSize.height)/i),r!=a&&(n.text(st(t.start,r||t.end?u(M(t),o*r):null,y("timeFormat"))),a=r)},stop:function(n,a){D("eventResizeStop",this,t,n,a),r?nt(this,t,0,o*r,n,a):(e.css("z-index",8),K(t,e))}})}var m=this;m.renderEvents=n,m.compileDaySegs=a,m.clearEvents=r,m.slotSegHtml=l,m.bindDaySeg=f,ft.call(m);var y=m.opt,D=m.trigger,b=m.isEventDraggable,w=m.isEventResizable,M=m.eventEnd,S=m.reportEvents,x=m.reportEventClear,E=m.eventElementHandlers,H=m.setHeight,L=m.getDaySegmentContainer,N=m.getSlotSegmentContainer,A=m.getHoverListener,O=m.getMaxMinute,_=m.getMinMinute,B=m.timePosition,I=m.colContentLeft,q=m.colContentRight,j=m.renderDaySegs,Y=m.resizableDayEvent,P=m.getColCnt,J=m.getColWidth,U=m.getSnapHeight,Z=m.getSnapMinutes,$=m.getBodyContent,G=m.reportEventElement,K=m.showEvents,tt=m.hideEvents,et=m.eventDrop,nt=m.eventResize,rt=m.renderDayOverlay,at=m.clearOverlays,it=m.calendar,ot=it.formatDate,st=it.formatDates}function lt(t){var e,n,r,a,i,o;for(e=t.length-1;e>0;e--)for(a=t[e],n=0;n<a.length;n++)for(i=a[n],r=0;r<t[e-1].length;r++)o=t[e-1][r],E(i,o)&&(o.forward=Math.max(o.forward||0,(i.forward||0)+1))}function ut(n,r,a){function i(t,e){var n=R[t];return"object"==typeof n?J(n,e||a):n}function o(t,e){return r.trigger.apply(r,[t,e||x].concat(Array.prototype.slice.call(arguments,2),[x]))}function s(t){return f(t)&&!i("disableDragging")}function l(t){return f(t)&&!i("disableResizing")}function f(t){return K(t.editable,(t.source||{}).editable,i("editable"))}function v(t){z={};var e,n,r=t.length;for(e=0;r>e;e++)n=t[e],z[n._id]?z[n._id].push(n):z[n._id]=[n]}function h(t){return t.end?d(t.end):E(t)}function g(t,e){H.push(e),F[t._id]?F[t._id].push(e):F[t._id]=[e]}function p(){H=[],F={}}function m(t,e){e.click(function(n){return e.hasClass("ui-draggable-dragging")||e.hasClass("ui-resizable-resizing")?void 0:o("eventClick",this,t,n)}).hover(function(e){o("eventMouseover",this,t,e)},function(e){o("eventMouseout",this,t,e)})}function y(t,e){b(t,e,"show")}function D(t,e){b(t,e,"hide")}function b(t,e,n){var r,a=F[t._id],i=a.length;for(r=0;i>r;r++)e&&a[r][0]==e[0]||a[r][n]()}function w(t,e,n,r,a,i,s){var c=e.allDay,l=e._id;C(z[l],n,r,a),o("eventDrop",t,e,n,r,a,function(){C(z[l],-n,-r,c),k(l)},i,s),k(l)}function M(e,n,r,a,i,s){var c=n._id;S(z[c],r,a),o("eventResize",e,n,r,a,function(){S(z[c],-r,-a),k(c)},i,s);for(var l=n.title.indexOf("[")+1,u="";l<n.title.indexOf("]");)u+=n.title[l],l++;return"false"==changeEventDragEtc(u)?(eventL(),!1):"false"==currentuserLoginCheck(u)?(eventL(),!1):"false"==calculateDatetime(r,a,n.start,n.end)?void eventL():confirm("Do you want to change ?")?(t.ajax({url:"/sgterp/protected/addClassAndAudiReservation",type:"POST",data:"reservationId="+u+"&minuteDelta="+a+"&dayDelta="+r+"&event=resize",success:function(t){eventL()},error:function(t){alert("Internal server problem!"),eventL()}}),void k(c)):void eventL()}function C(t,n,r,a){r=r||0;for(var i,o=t.length,s=0;o>s;s++)i=t[s],a!==e&&(i.allDay=a),u(c(i.start,n,!0),r),i.end&&(i.end=u(c(i.end,n,!0),r)),T(i,R)}function S(t,e,n){n=n||0;for(var r,a=t.length,i=0;a>i;i++)r=t[i],r.end=u(c(h(r),e,!0),n),T(r,R)}var x=this;x.element=n,x.calendar=r,x.name=a,x.opt=i,x.trigger=o,x.isEventDraggable=s,x.isEventResizable=l,x.reportEvents=v,x.eventEnd=h,x.reportEventElement=g,x.reportEventClear=p,x.eventElementHandlers=m,x.showEvents=y,x.hideEvents=D,x.eventDrop=w,x.eventResize=M;var E=x.defaultEventEnd,T=r.normalizeEvent,k=r.reportEventChange,z={},H=[],F={},R=r.options}function ft(){function n(t,e){var n,r,c,d,p,m,y,D,b=B(),w=T(),M=k(),C=0,S=t.length;for(b[0].innerHTML=a(t),i(t,b.children()),o(t),s(t,b,e),l(t),u(t),f(t),n=v(),r=0;w>r;r++){for(c=0,d=[],p=0;M>p;p++)d[p]=0;for(;S>C&&(m=t[C]).row==r;){for(y=Y(d.slice(m.startCol,m.endCol)),m.top=y,y+=m.outerHeight,D=m.startCol;D<m.endCol;D++)d[D]=y;C++}n[r].height(Y(d))}g(t,h(n))}function r(e,n,r){var o,s,c,d=t("<div/>"),p=B(),m=e.length;for(d[0].innerHTML=a(e),o=d.children(),p.append(o),i(e,o),l(e),u(e),f(e),g(e,h(v())),o=[],s=0;m>s;s++)c=e[s].element,c&&(e[s].row===n&&c.css("top",r),o.push(c[0]));return t(o)}function a(t){var e,n,r,a,i,o,s,c,l,u,f=y("isRTL"),d=t.length,v=F(),h=v.left,g=v.right,p="";for(e=0;d>e;e++)n=t[e],r=n.event,i=["fc-event","fc-event-hori"],b(r)&&i.push("fc-event-draggable"),n.isStart&&i.push("fc-event-start"),n.isEnd&&i.push("fc-event-end"),f?(o=A(n.end.getDay()-1),s=A(n.start.getDay()),c=n.isEnd?L(o):h,l=n.isStart?N(s):g):(o=A(n.start.getDay()),s=A(n.end.getDay()-1),c=n.isStart?L(o):h,l=n.isEnd?N(s):g),i=i.concat(r.className),r.source&&(i=i.concat(r.source.className||[])),a=r.url,u=Q(r,y),p+=a?"<a href='"+V(a)+"'":"<div",p+=" class='"+i.join(" ")+"' style='position:absolute;z-index:8;left:"+c+"px;"+u+"'><div class='fc-event-inner'>",!r.allDay&&n.isStart&&(p+="<span class='fc-event-time'>"+V(q(r.start,r.end,y("timeFormat")))+"</span>"),p+="<span class='fc-event-title'>"+V(r.title)+"</span></div>",n.isEnd&&w(r)&&(p+="<div class='ui-resizable-handle ui-resizable-"+(f?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),p+="</"+(a?"a":"div")+">",n.left=c,n.outerWidth=l-c,n.startCol=o,n.endCol=s+1;return p}function i(e,n){var r,a,i,o,s,c=e.length;for(r=0;c>r;r++)a=e[r],i=a.event,o=t(n[r]),s=D("eventRender",i,i,o),s===!1?o.remove():(s&&s!==!0&&(s=t(s).css({position:"absolute",left:a.left}),o.replaceWith(s),o=s),a.element=o)}function o(t){var e,n,r,a=t.length;for(e=0;a>e;e++)n=t[e],r=n.element,r&&C(n.event,r)}function s(t,e,n){var r,a,i,o,s=t.length;for(r=0;s>r;r++)a=t[r],i=a.element,i&&(o=a.event,o._id===n?I(o,i,a):i[0]._fci=r);z(e,t,I)}function l(t){var n,r,a,i,o,s=t.length,c={};for(n=0;s>n;n++)r=t[n],a=r.element,a&&(i=r.key=X(a[0]),o=c[i],o===e&&(o=c[i]=R(a,!0)),r.hsides=o)}function u(t){var e,n,r,a=t.length;for(e=0;a>e;e++)n=t[e],r=n.element,r&&(r[0].style.width=Math.max(0,n.outerWidth-n.hsides)+"px")}function f(t){var n,r,a,i,o,s=t.length,c={};for(n=0;s>n;n++)r=t[n],a=r.element,a&&(i=r.key,o=c[i],o===e&&(o=c[i]=_(a)),r.outerHeight=a[0].offsetHeight+o)}function v(){var t,e=T(),n=[];for(t=0;e>t;t++)n[t]=H(t).find("div.fc-day-content > div");return n}function h(t){var e,n=t.length,r=[];for(e=0;n>e;e++)r[e]=t[e][0].offsetTop;return r}function g(t,e){var n,r,a,i,o=t.length;for(n=0;o>n;n++)r=t[n],a=r.element,a&&(a[0].style.top=e[r.row]+(r.top||0)+"px",i=r.event,D("eventAfterRender",i,i,a))}function p(e,n,a){var i=y("isRTL"),o=i?"w":"e",s=n.find(".ui-resizable-"+o),l=!1;U(n),n.mousedown(function(t){t.preventDefault()}).click(function(t){l&&(t.preventDefault(),t.stopImmediatePropagation())}),s.mousedown(function(s){function u(n){D("eventResizeStop",this,e,n),t("body").css("cursor",""),h.stop(),P(),f&&E(this,e,f,0,n),setTimeout(function(){l=!1},0)}if(1==s.which){l=!0;var f,v,h=m.getHoverListener(),g=T(),p=k(),y=i?-1:1,b=i?p-1:0,w=n.css("top"),C=t.extend({},e),z=W(e.start);J(),t("body").css("cursor",o+"-resize").one("mouseup",u),D("eventResizeStart",this,e,s),h.start(function(t,n){if(t){var s=Math.max(z.row,t.row),l=t.col;1==g&&(s=0),s==z.row&&(l=i?Math.min(z.col,l):Math.max(z.col,l)),f=7*s+l*y+b-(7*n.row+n.col*y+b);var u=c(M(e),f,!0);if(f){C.end=u;var h=v;v=r(O([C]),a.row,w),v.find("*").css("cursor",o+"-resize"),h&&h.remove(),x(e)}else v&&(S(e),v.remove(),v=null);P(),j(e.start,c(d(u),1))}},s)}})}var m=this;m.renderDaySegs=n,m.resizableDayEvent=p;var y=m.opt,D=m.trigger,b=m.isEventDraggable,w=m.isEventResizable,M=m.eventEnd,C=m.reportEventElement,S=m.showEvents,x=m.hideEvents,E=m.eventResize,T=m.getRowCnt,k=m.getColCnt,H=(m.getColWidth,m.allDayRow),F=m.allDayBounds,L=m.colContentLeft,N=m.colContentRight,A=m.dayOfWeekCol,W=m.dateCell,O=m.compileDaySegs,B=m.getDaySegmentContainer,I=m.bindDaySeg,q=m.calendar.formatDates,j=m.renderDayOverlay,P=m.clearOverlays,J=m.clearSelection}function dt(){function e(t,e,a){n(),e||(e=c(t,a)),l(t,e,a),r(t,e,a)}function n(t){f&&(f=!1,u(),s("unselect",null,t))}function r(t,e,n,r){f=!0,s("select",null,t,e,n,r)}function a(e){var a=i.cellDate,s=i.cellIsAllDay,c=i.getHoverListener(),f=i.reportDayClick;if(1==e.which&&o("selectable")){n(e);var d;c.start(function(t,e){u(),t&&s(t)?(d=[a(e),a(t)].sort(j),l(d[0],d[1],!0)):d=null},e),t(document).one("mouseup",function(t){c.stop(),d&&(+d[0]==+d[1]&&f(d[0],!0,t),r(d[0],d[1],!0,t))})}}var i=this;i.select=e,i.unselect=n,i.reportSelection=r,i.daySelectionMousedown=a;var o=i.opt,s=i.trigger,c=i.defaultSelectionEnd,l=i.renderSelection,u=i.clearSelection,f=!1;o("selectable")&&o("unselectAuto")&&t(document).mousedown(function(e){var r=o("unselectCancel");r&&t(e.target).parents(r).length||n(e)})}function vt(){function e(e,n){var r=i.shift();return r||(r=t("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),r[0].parentNode!=n[0]&&r.appendTo(n),a.push(r.css(e).show()),r}function n(){for(var t;t=a.shift();)i.push(t.hide().unbind())}var r=this;r.renderOverlay=e,r.clearOverlays=n;var a=[],i=[]}function ht(t){var e,n,r=this;r.build=function(){e=[],n=[],t(e,n)},r.cell=function(t,r){var a,i=e.length,o=n.length,s=-1,c=-1;for(a=0;i>a;a++)if(r>=e[a][0]&&r<e[a][1]){s=a;break}for(a=0;o>a;a++)if(t>=n[a][0]&&t<n[a][1]){c=a;break}return s>=0&&c>=0?{row:s,col:c}:null},r.rect=function(t,r,a,i,o){var s=o.offset();return{top:e[t][0]-s.top,left:n[r][0]-s.left,width:n[i][1]-n[r][0],height:e[a][1]-e[t][0]}}}function gt(e){function n(t){pt(t);var n=e.cell(t.pageX,t.pageY);(!n!=!o||n&&(n.row!=o.row||n.col!=o.col))&&(n?(i||(i=n),a(n,i,n.row-i.row,n.col-i.col)):a(n,i),o=n)}var r,a,i,o,s=this;s.start=function(s,c,l){a=s,i=o=null,e.build(),n(c),r=l||"mousemove",t(document).bind(r,n)},s.stop=function(){return t(document).unbind(r,n),o}}function pt(t){t.pageX===e&&(t.pageX=t.originalEvent.pageX,t.pageY=t.originalEvent.pageY)}function mt(t){function n(e){return a[e]=a[e]||t(e)}var r=this,a={},i={},o={};r.left=function(t){return i[t]=i[t]===e?n(t).position().left:i[t]},r.right=function(t){return o[t]=o[t]===e?r.left(t)+n(t).width():o[t]},r.clear=function(){a={},i={},o={}}}var yt={defaultView:"agendaWeek",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*"},Dt={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},bt=t.fullCalendar={version:"1.6.1"},wt=bt.views={};t.fn.fullCalendar=function(n){if("string"==typeof n){var a,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=t.data(this,"fullCalendar");if(r&&t.isFunction(r[n])){var o=r[n].apply(r,i);a===e&&(a=o),"destroy"==n&&t.removeData(this,"fullCalendar")}}),a!==e?a:this}var o=n.eventSources||[];return delete n.eventSources,n.events&&(o.push(n.events),delete n.events),n=t.extend(!0,{},yt,n.isRTL||n.isRTL===e&&yt.isRTL?Dt:{},n),this.each(function(e,a){var i=t(a),s=new r(i,n,o);i.data("fullCalendar",s),s.render()}),this},bt.sourceNormalizers=[],bt.sourceFetchers=[];var Mt={dataType:"json",cache:!1},Ct=1;bt.addDays=c,bt.cloneDate=d,bt.parseDate=m,bt.parseISO8601=y,bt.parseTime=D,bt.formatDate=b,bt.formatDates=w;var St=["sun","mon","tue","wed","thu","fri","sat"],xt=864e5,Et=36e5,Tt=6e4,kt={s:function(t){return t.getSeconds()},ss:function(t){return P(t.getSeconds())},m:function(t){return t.getMinutes()},mm:function(t){return P(t.getMinutes())},h:function(t){return t.getHours()%12||12},hh:function(t){return P(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return P(t.getHours())},d:function(t){return t.getDate()},dd:function(t){return P(t.getDate())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return P(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},yy:function(t){return(t.getFullYear()+"").substring(2)},yyyy:function(t){return t.getFullYear()},t:function(t){return t.getHours()<12?"a":"p"},tt:function(t){return t.getHours()<12?"am":"pm"},T:function(t){return t.getHours()<12?"A":"P"},TT:function(t){return t.getHours()<12?"AM":"PM"},u:function(t){return b(t,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(t){var e=t.getDate();return e>10&&20>e?"th":["st","nd","rd"][e%10-1]||"th"},w:function(t,e){return e.weekNumberCalculation(t)},W:function(t){return M(t)}};bt.dateFormatters=kt,bt.applyAll=G,wt.month=tt,wt.basicWeek=et,wt.basicDay=nt,n({weekMode:"fixed"}),wt.agendaWeek=it,wt.agendaDay=ot,n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}(jQuery);