function contactsController(a,t){a.pageToGet=0,a.state="busy",a.lastAction="",a.url="/sgterp/protected/contacts/",a.errorOnSubmit=!1,a.errorIllegalAccess=!1,a.displayMessageToUser=!1,a.displayValidationError=!1,a.displaySearchMessage=!1,a.displaySearchButton=!1,a.displayCreateContactButton=!1,a.contact={},a.searchFor="",a.getContactList=function(){var e=a.url;a.lastAction="list",a.startDialogAjaxRequest();var r={params:{page:a.pageToGet}};t.get(e,r).success(function(t){a.finishAjaxCallOnSuccess(t,null,!1)}).error(function(){a.state="error",a.displayCreateContactButton=!1})},a.populateTable=function(t){t.pagesCount>0?(a.state="list",a.page={source:t.contacts,currentPage:a.pageToGet,pagesCount:t.pagesCount,totalContacts:t.totalContacts},a.page.pagesCount<=a.page.currentPage&&(a.pageToGet=a.page.pagesCount-1,a.page.currentPage=a.page.pagesCount-1),a.displayCreateContactButton=!0,a.displaySearchButton=!0):(a.state="noresult",a.displayCreateContactButton=!0,a.searchFor||(a.displaySearchButton=!1)),t.actionMessage||t.searchMessage?(a.displayMessageToUser="search"!=a.lastAction,a.page.actionMessage=t.actionMessage,a.page.searchMessage=t.searchMessage):a.displayMessageToUser=!1},a.changePage=function(t){a.pageToGet=t,a.searchFor?a.searchContact(a.searchFor,!0):a.getContactList()},a.exit=function(t){$(t).modal("hide"),a.contact={},a.errorOnSubmit=!1,a.errorIllegalAccess=!1,a.displayValidationError=!1},a.finishAjaxCallOnSuccess=function(t,e,r){a.populateTable(t),$("#loadingModal").modal("hide"),r||e&&a.exit(e),a.lastAction=""},a.startDialogAjaxRequest=function(){a.displayValidationError=!1,$("#loadingModal").modal("show"),a.previousState=a.state,a.state="busy"},a.handleErrorInDialogs=function(t){return $("#loadingModal").modal("hide"),a.state=a.previousState,403==t?void(a.errorIllegalAccess=!0):(a.errorOnSubmit=!0,void(a.lastAction=""))},a.addSearchParametersIfNeeded=function(t,e){t.params||(t.params={}),t.params.page=a.pageToGet,a.searchFor&&(t.params.searchFor=a.searchFor)},a.resetContact=function(){a.contact={}},a.createContact=function(e){if(!e.$valid)return void(a.displayValidationError=!0);a.lastAction="create";var r=a.url,o={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};a.addSearchParametersIfNeeded(o,!1),a.startDialogAjaxRequest(),t.post(r,$.param(a.contact),o).success(function(t){a.finishAjaxCallOnSuccess(t,"#addContactsModal",!1)}).error(function(t,e,r,o){a.handleErrorInDialogs(e)})},a.selectedContact=function(t){var e=angular.copy(t);a.contact=e},a.updateContact=function(e){if(!e.$valid)return void(a.displayValidationError=!0);a.lastAction="update";var r=a.url+a.contact.id;a.startDialogAjaxRequest();var o={};a.addSearchParametersIfNeeded(o,!1),t.put(r,a.contact,o).success(function(t){a.finishAjaxCallOnSuccess(t,"#updateContactsModal",!1)}).error(function(t,e,r,o){a.handleErrorInDialogs(e)})},a.searchContact=function(e,r){if(!a.searchFor&&!e.$valid)return void(a.displayValidationError=!0);a.lastAction="search";var o=a.url+a.searchFor;a.startDialogAjaxRequest();var s={};a.searchFor&&a.addSearchParametersIfNeeded(s,r),t.get(o,s).success(function(t){a.finishAjaxCallOnSuccess(t,"#searchContactsModal",r),a.displaySearchMessage=!0}).error(function(t,e,r,o){a.handleErrorInDialogs(e)})},a.deleteContact=function(){a.lastAction="delete";var e=a.url+a.contact.id;a.startDialogAjaxRequest();var r={searchFor:a.searchFor,page:a.pageToGet};t({method:"DELETE",url:e,params:r}).success(function(t){a.resetContact(),a.finishAjaxCallOnSuccess(t,"#deleteContactsModal",!1)}).error(function(t,e,r,o){a.handleErrorInDialogs(e)})},a.resetSearch=function(){a.searchFor="",a.pageToGet=0,a.getContactList(),a.displaySearchMessage=!1},a.getContactList()}