function changeDate(e,t){var a=e;$("#"+t).val(a)}function IsNumeric(e){e.shiftKey?e.preventDefault():46==e.keyCode||8==e.keyCode||9==e.keyCode||37==e.keyCode||39==e.keyCode||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}function isAlphaNumeric(e){46==e.keyCode||8==e.keyCode||32==e.keyCode||9==e.keyCode||37==e.keyCode||39==e.keyCode||(e.shiftKey||(e.keyCode<65||e.keyCode>90)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105))&&e.preventDefault()}var specialKeys=new Array;specialKeys.push(8);var TableData=function(){var e=function(){var e=$("#sample_1").dataTable({aoColumnDefs:[{bSortable:!1,bSearchable:!1,aTargets:[-1,-2]}],oLanguage:{sLengthMenu:"Show _MENU_ Rows",sSearch:"",oPaginate:{sPrevious:"",sNext:""}},aaSorting:[[1,"asc"]],aLengthMenu:[[5,10,15,20,-1],[5,10,15,20,"All"]],iDisplayLength:10});$("#sample_1_wrapper .dataTables_filter input").addClass("form-size input-sm").attr("placeholder","Search"),$("#sample_1_wrapper .dataTables_length select").addClass("m-wrap small"),$("#sample_1_wrapper .dataTables_length select").select2(),$('#sample_1_column_toggler input[type="checkbox"]').change(function(){var t=parseInt($(this).attr("data-column")),a=e.fnSettings().aoColumns[t].bVisible;e.fnSetColumnVis(t,a?!1:!0)})},t=function(){function e(e,t){for(var a=e.fnGetData(t),n=$(">td",t),l=0,s=n.length;s>l;l++)e.fnUpdate(a[l],t,l,!1);e.fnDraw()}function t(e,t){var a=e.fnGetData(t),n=$(">td",t);$.ajax({url:"facultylist",type:"POST",success:function(e){var t=JSON.parse(e),a=Object.keys(t).length/2,n=document.getElementById("facultySelect"),l=document.createElement("option");l.value="select",l.innerHTML="Select Faculty",l.selected="selected",n.appendChild(l);for(var s=0;a>s;s++){facultyid="facultyid"+s,facultyname="facultyname"+s;var o=document.createElement("option");o.value=t[facultyid],o.innerHTML=t[facultyname],n.appendChild(o)}},error:function(e){alert("Unable to fetch data, Please try again!")}}),n[0].innerHTML='<input type="text" maxlength="2" class="form-control" style="width:100%" onkeydown="IsNumeric(event);" value="'+a[0]+'" required>',n[1].innerHTML='<input type="text" class="form-control" style="width:100%" value="'+a[1]+'">',n[2].innerHTML='<select id="facultySelect" style="width:100%" class="form-control"></select>',n[3].innerHTML='<select class="form-control" style="width:100%"><option value="select" selected>Select Type</option><option value="A">A</option><option value="B">B</option></select>',n[4].innerHTML='<input type="text" id="startYear"  style="width:100%" class="date-picker-year form-control" value="'+a[4]+'" onchange="changeDate(this.value,this.id);" required>',n[5].innerHTML='<select class="form-control" style="width:100%"><option value="select" selected>Select Pattern</option><option value="Trimester">Trimester</option><option value="Semester">Semester</option><option value="Year">Year</option></select>',n[6].innerHTML='<input type="text" class="form-control" style="width:100%" onkeydown="IsNumeric(event);" value="'+a[6]+'">',n[7].innerHTML='<select style="width:100%" class="form-control"><option value="select" selected>Select Status</option><option value="Active" >Active</option><option value="Inactive">Inactive</option><option value="Blocked_Admission">Blocked_Admission</option></select>',n[8].innerHTML='<a class="save-row btn btn-green btn-sm"  href=""><i class="fa fa-save"></i> Save</a>',n[9].innerHTML='<a class="cancel-row btn btn-bricky btn-sm"  href=""><i class="clip-cancel-circle"></i> Cancel</a>',n[10].innerHTML='<input type="text" class="form-control" style="width:100%;" value="0" >',n[10].style.display="none",$("#sample_2").css("width","100%"),$(".date-picker-year").datepicker({format:"yyyy",startView:1,minViewMode:2,multidateSeparator:"-"})}function a(e,t){var a=e.fnGetData(t),n=t.cells,a=(n[0].innerHTML,e.fnGetData(t)),l=$(">td",t);$.ajax({url:"facultylist",type:"POST",success:function(e){for(var t=JSON.parse(e),n=Object.keys(t).length/2,l=document.getElementById("facultySelectEdit"),s=0;n>s;s++){facultyid="facultyid"+s,facultyname="facultyname"+s;var o=document.createElement("option");o.value=t[facultyid],o.innerHTML=t[facultyname],a[2]==t[facultyname]&&(o.selected="selected"),l.appendChild(o)}},error:function(e){alert("Unable to fetch data, Please try again!")}}),l[0].innerHTML='<input type="text" maxlength="2" style="width:100%" value="'+a[0]+'" readonly>',l[1].innerHTML='<input type="text"  style="width:100%" value="'+a[1]+'" required>',l[2].innerHTML='<select id="facultySelectEdit" class="form-control" style="width:100%" ></select>',l[3].innerHTML='<select class="form-control" style="width:100%" required><option value="" >Select Type</option><option value="A">A</option><option value="B">B</option></select>',l[4].innerHTML='<input type="text" id="startYear" class="date-picker-year form-control" style="width:100%" value="'+a[4]+'" onchange="changeDate(this.value,this.id);" required>',l[5].innerHTML='<select id="pattern" class="form-control" style="width:100%"><option value="select">Select</option><option value="Trimester">Trimester</option><option value="Semester">Semester</option><option value="Year">Year</option></select>',l[6].innerHTML='<input type="number" class="form-control" style="width:100%" value="'+a[6]+'" required>',l[7].innerHTML='<select name="courseStatus" style="width:100%" class="form-control"><option value="Active">Active</option><option value="Inactive">Inactive</option><option value="Blocked_Admission">Blocked_Admission</option></select>',l[8].innerHTML='<a class="save-row btn btn-green btn-sm"  href=""><i class="fa fa-save"></i> Save</a>',l[9].innerHTML='<a class="cancel-row btn btn-bricky btn-sm"  href=""><i class="clip-cancel-circle"></i> Cancel</a>',l[10].innerHTML='<input type="text" class="form-control" style="width:100%;" value="'+a[10]+'" >',l[10].style.display="none",$("#pattern").val(a[5]),$('select[name="courseStatus"]').val(a[7]),$("#sample_2").css("width","100%"),$(".date-picker-year").datepicker({format:"yyyy",startView:1,minViewMode:2,multidateSeparator:"-"})}function n(e,t){var a=$("input",t),n=$("select",t),o=a[1].value,r=o.replace(/&/g,"%26");$.ajax({url:"createcourse",type:"POST",data:"courseId="+a[4].value+"&courseCode="+a[0].value+"&courseName="+r+"&faculty.facultyId="+n[0].value+"&reappearType="+n[1].value+"&courseYear="+a[2].value+"&courseDuration="+a[3].value+"&coursePattern="+n[2].value+"&status="+n[3].value,success:function(o){"success"==o?(e.fnUpdate(a[0].value,t,0,!1),e.fnUpdate(a[1].value,t,1,!1),e.fnUpdate(n[0].selectedOptions[0].text,t,2,!1),e.fnUpdate(n[1].selectedOptions[0].text,t,3,!1),e.fnUpdate(a[2].value,t,4,!1),e.fnUpdate(n[2].selectedOptions[0].text,t,5,!1),e.fnUpdate(a[3].value,t,6,!1),e.fnUpdate(n[3].selectedOptions[0].text,t,7,!1),e.fnUpdate('<a class="edit-row btn btn-green btn-sm"  href=""><i class="fa fa-edit"></i> Edit</a>',t,8,!1),e.fnUpdate('<a class="delete-row btn btn-bricky btn-sm" href=""><i class="fa fa-trash-o"></i> Delete</a>',t,9,!1),e.fnDraw(),l=!1,s=null,location.reload(),"resizable,location,menubar,toolbar,scrollbars,status"):"error"==o&&alert("Unable to save, Course Code already exists for selected Faculty !")},error:function(e){alert("Unable to save, Please try again!")}})}var l=!1,s=null;$.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> loading...'}),$.ajax({url:"/sgterp/protected/adminCourseList",type:"POST",success:function(t){for(var a=0;a<t.length;a++)if(0==l){if(s&&e(o,s),l=!0,checkPermission)var n=o.fnAddData(["","","","","","","","","",""]);else var n=o.fnAddData(["","","","","","","",""]);var r=o.fnGetNodes(n[0]);o.fnUpdate(t[a].courseCode,r,0,!1),o.fnUpdate(t[a].courseName,r,1,!1),o.fnUpdate(t[a].facultyName,r,2,!1),o.fnUpdate(t[a].reappearType,r,3,!1),o.fnUpdate(t[a].courseYear,r,4,!1),o.fnUpdate(t[a].coursePattern,r,5,!1),o.fnUpdate(t[a].courseDuration,r,6,!1),o.fnUpdate(t[a].courseStatus,r,7,!1),checkPermission&&(o.fnUpdate('<a class="edit-row btn btn-green btn-sm" href=""><i class="fa fa-edit"></i> Edit</a>',r,8,!1),o.fnUpdate('<a class="delete-row btn btn-bricky btn-sm" href=""><i class="fa fa-trash-o"></i> Delete</a>',r,9,!1)),o.fnUpdate(t[a].courseId,r,10,!1),r.cells[10].style.display="none",o.fnDraw(),l=!1,s=null}$.unblockUI()},error:function(e){alert("Unable to fetch data, Please try again!"),$.unblockUI()}}),$("body").on("click",".add-row",function(a){if(a.preventDefault(),0==l){s&&e(o,s),l=!0;var n=o.fnAddData(["","","","","","","","","",""]),r=o.fnGetNodes(n[0]);t(o,r),s=r}}),$("#sample_2").on("click",".cancel-row",function(t){if(t.preventDefault(),l){l=!1,s=null;var a=$(this).parents("tr")[0];o.fnDeleteRow(a)}else e(o,s),s=null}),$("#sample_2").on("click",".delete-row",function(e){e.preventDefault(),l&&s&&(o.fnDeleteRow(s),l=!1);var t=$(this).parents("tr")[0],a=t.cells,n=a[9].innerHTML;bootbox.confirm("Are you sure to delete this course?",function(e){e&&($.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> Delete Course...'}),$.mockjax({url:"/tabledata/delete/webservice",dataType:"json",responseTime:1e3,responseText:{say:"ok"}}),$.ajax({url:"/tabledata/delete/webservice",dataType:"json",success:function(e){$.unblockUI(),"ok"==e.say&&$.ajax({url:"deletecourse",type:"POST",data:"courseId="+n,success:function(e){o.fnDeleteRow(t),location.reload()},error:function(e){alert("Course Already in use")}})}}))})}),$("#sample_2").on("click",".save-row",function(e){e.preventDefault();var t=$(this).parents("tr")[0],a=t.cells,l=a[0].children[0].value,s=a[1].children[0].value,r=a[2].children[0].value,i=a[3].children[0].value,c=a[5].children[0].value,u=a[4].children[0].value,d=a[6].children[0].value;return null==l||""==l?(alert("Please Enter Course Code"),!1):null==s||""==s?(alert("Please Enter Course Name"),!1):null==r||""==r||"select"==r?(alert("Please Select Faculty"),!1):null==i||""==i?(alert("Please Enter Course Year"),!1):null==u||""==u||"select"==u?(alert("Please Select Course Pattern"),!1):null==c||""==c?(alert("Please Enter Course Duration"),!1):null==d||""==d||"select"==d?(alert("Please Select Course Status"),!1):($.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> saving data...'}),$.mockjax({url:"/tabledata/add/webservice",dataType:"json",responseTime:1e3,responseText:{say:"ok"}}),void $.ajax({url:"/tabledata/add/webservice",dataType:"json",success:function(e){$.unblockUI(),"ok"==e.say&&n(o,t)}}))}),$("#sample_2").on("click",".edit-row",function(t){t.preventDefault(),s&&(l?(o.fnDeleteRow(s),l=!1):e(o,s));var n=$(this).parents("tr")[0];a(o,n),s=n});var o=$("#sample_2").dataTable({aoColumnDefs:[{bSortable:!1,bSearchable:!1,aTargets:[-1,-2]}],oLanguage:{sLengthMenu:"Show _MENU_ Rows",sSearch:"",oPaginate:{sPrevious:"",sNext:""}},aaSorting:[[1,"asc"]],aLengthMenu:[[5,10,15,20,-1],[5,10,15,20,"All"]],iDisplayLength:10});$("#sample_2_wrapper .dataTables_filter input").addClass("form-size input-sm").attr("placeholder","Search"),$("#sample_2_wrapper .dataTables_length select").addClass("m-wrap small"),$("#sample_2_wrapper .dataTables_length select").select2(),$('#sample_2_column_toggler input[type="checkbox"]').change(function(){var e=parseInt($(this).attr("data-column")),t=o.fnSettings().aoColumns[e].bVisible;o.fnSetColumnVis(e,t?!1:!0)})};return{init:function(){e(),t()}}}();