function changeDate(e,a){var t=e+"-"+(parseInt(e)+1);$("#"+a).val(t)}var TableData=function(){var e=function(){var e=$("#sample_1").dataTable({aoColumnDefs:[{bSortable:!1,bSearchable:!1,aTargets:[0,-1,-2]}],oLanguage:{sLengthMenu:"Show _MENU_ Rows",sSearch:"",oPaginate:{sPrevious:"",sNext:""}},aaSorting:[[1,"asc"]],aLengthMenu:[[5,10,15,20,-1],[5,10,15,20,"All"]],iDisplayLength:10});$("#sample_1_wrapper .dataTables_filter input").addClass("form-control input-sm").attr("placeholder","Search"),$("#sample_1_wrapper .dataTables_length select").addClass("m-wrap small"),$("#sample_1_wrapper .dataTables_length select").select2(),$('#sample_1_column_toggler input[type="checkbox"]').change(function(){var a=parseInt($(this).attr("data-column")),t=e.fnSettings().aoColumns[a].bVisible;e.fnSetColumnVis(a,t?!1:!0)})},a=function(){function e(e,a){for(var t=e.fnGetData(a),n=$(">td",a),s=0,l=n.length;l>s;s++)e.fnUpdate(t[s],a,s,!1);e.fnDraw()}function a(e,a){var t=e.fnGetData(a),n=$(">td",a);n[0].innerHTML='<input type="text" class="form-control" style="width:100%;" value="'+t[0]+'" >',n[0].style.display="none",n[1].innerHTML='<input type="text" id="startYear" class="date-picker-year form-control" style="width:100%;" value="'+t[1]+'" onchange="changeDate(this.value,this.id);" required>',n[2].innerHTML='<select class="form-control"><option value="true">true</option><option value="false" selected>false</option></select>',n[3].innerHTML='<select class="form-control"><option value="true">true</option><option value="false" selected>false</option></select>',n[4].innerHTML='<a class="save-row btn btn-green btn-sm" href=""><i class="fa fa-save"></i> Save</a>',n[5].innerHTML='<a class="cancel-row btn btn-bricky btn-sm" href=""><i class="clip-cancel-circle"></i> Cancel</a>',$(".date-picker-year").datepicker({format:"yyyy",startView:1,minViewMode:2,multidateSeparator:"-"})}function t(e,a){var t=e.fnGetData(a),n=$(">td",a);n[0].innerHTML='<input type="text" readonly class="form-control" style="width:100%;" value="'+t[0]+'" style="display:none">',n[1].innerHTML='<input type="text" id="startYear" style="pointer-events: none; cursor: default; background-color:#eee;" width:100%; readonly="readonly" class="date-picker-year form-control"  value="'+t[1]+'" onchange="changeDate(this.value,this.id);" required>',n[2].innerHTML='<select class="form-control" id="currentSession"><option value="true">true</option><option value="false">false</option></select>',n[3].innerHTML='<select class="form-control" id="admissionSession"><option value="true">true</option><option value="false">false</option></select>',n[4].innerHTML='<a class="save-edit-row btn btn-green btn-sm" href=""><i class="fa fa-save"></i> Save</a>',n[5].innerHTML='<a class="cancel-row btn btn-bricky btn-sm" href=""><i class="clip-cancel-circle"></i> Cancel</a>',$("#currentSession").val(t[2]),$("#admissionSession").val(t[3]),$(".date-picker-year").datepicker({format:"yyyy",startView:1,minViewMode:2,multidateSeparator:"-"})}function n(e,a){var t=$("input",a),n=$("select",a),s=$("#sample_2").dataTable().fnGetNodes();if(s.length<=1){if("false"==n[0].value){if(1!=confirm("At-least one session must be current session!"))return!1;n[0].value="true"}if("false"==n[1].value){if(1!=confirm("At-least one session must be admission session!"))return!1;n[1].value="true"}}return null==t[1].value||""==t[1].value||"-NaN"==t[1].value?(alert("Please select year"),!1):"true"==n[0].value&&0==warnBeforeUpdate("sample_2",n[0].value,2,"no","Current Session")?!1:"true"==n[1].value&&0==warnBeforeUpdate("sample_2",n[1].value,3,"no","Admission Session")?!1:void $.ajax({url:"createsession",type:"POST",data:"value="+t[1].value+"&currentSession="+n[0].value+"&admissionSession="+n[1].value,success:function(s){e.fnUpdate('<a href="">'+t[0].value+"</a>",a,0,!1),e.fnUpdate(t[1].value,a,1,!1),e.fnUpdate(n[0].value,a,2,!1),e.fnUpdate(n[1].value,a,3,!1),e.fnUpdate('<a class="edit-row btn btn-green btn-sm" href=""><i class="fa fa-edit"></i> Edit</a>',a,4,!1),e.fnUpdate('<a class="delete-row btn btn-bricky btn-sm" href=""><i class="fa fa-trash-o"></i> Delete</a>',a,5,!1),e.fnDraw(),l=!1,r=null,location.reload()},error:function(e){alert("Duplicate session not allowed!")}})}function s(e,a){var t=$("input",a),n=$("select",a),s=$("#sample_2").dataTable().fnGetNodes();if("true"!=n[0].value){for(var i=0;i<s.length;i++){var o=!1,c=$(s[i]).find("td:eq(2)").html();if("true"==c){o=!0;break}}if(!o){if(1!=confirm("At-least one session must be current session!"))return!1;n[0].value="true"}}if("true"!=n[1].value){for(var i=0;i<s.length;i++){var o=!1,c=$(s[i]).find("td:eq(3)").html();if("true"==c){o=!0;break}}if(!o){if(1!=confirm("At-least one session must be Admission session!"))return!1;n[1].value="true"}}return null==t[1].value||""==t[1].value||"-NaN"==t[1].value?(alert("Please select year"),!1):"true"==n[0].value&&0==warnBeforeUpdate("sample_2",n[0].value,2,"no","Current Session")?!1:"true"==n[1].value&&0==warnBeforeUpdate("sample_2",n[1].value,3,"no","Admission Session")?!1:void $.ajax({url:"createsession",type:"POST",data:"sessionId="+t[0].value+"&value="+t[1].value+"&currentSession="+n[0].value+"&admissionSession="+n[1].value,success:function(s){e.fnUpdate('<a href="">'+t[0].value+"</a>",a,0,!1),e.fnUpdate(t[1].value,a,1,!1),e.fnUpdate(n[0].value,a,2,!1),e.fnUpdate(n[1].value,a,3,!1),e.fnUpdate('<a class="edit-row btn btn-green btn-sm" href=""><i class="fa fa-edit"></i> Edit</a>',a,4,!1),e.fnUpdate('<a class="delete-row btn btn-bricky btn-sm" href=""><i class="fa fa-trash-o"></i> Delete</a>',a,5,!1),e.fnDraw(),l=!1,r=null,location.reload()},error:function(e){alert("Duplicate session not allowed!")}})}var l=!1,r=null;$.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> loading...'}),$.ajax({url:"adminSessionList",type:"GET",success:function(a){for(var t=0;t<a.length;t++)if(0==l){if(r&&e(i,r),l=!0,checkPermission)var n=i.fnAddData(["","","","",""]);else var n=i.fnAddData(["","",""]);var s=i.fnGetNodes(n[0]);i.fnUpdate(a[t].sessionId,s,0,!1);var o=s.cells;o[0].style.display="none",i.fnUpdate(a[t].value,s,1,!1),i.fnUpdate(a[t].currentSession,s,2,!1),i.fnUpdate(a[t].admissionSession,s,3,!1),checkPermission&&(i.fnUpdate('<a class="edit-row btn btn-green btn-sm" href=""><i class="fa fa-edit"></i> Edit</a>',s,4,!1),i.fnUpdate('<a class="delete-row btn btn-bricky btn-sm" href=""><i class="fa fa-trash-o"></i> Delete</a>',s,5,!1)),i.fnDraw(),l=!1,r=null}$.unblockUI()},error:function(e){alert("Unable to fetch data, Please try again!"),$.unblockUI()}}),$("body").on("click",".add-row",function(t){if(t.preventDefault(),0==l){r&&e(i,r),l=!0;var n=i.fnAddData(["","","","",""]),s=i.fnGetNodes(n[0]);a(i,s),r=s}}),$("#sample_2").on("click",".cancel-row",function(a){if(a.preventDefault(),l){l=!1,r=null;var t=$(this).parents("tr")[0];i.fnDeleteRow(t)}else e(i,r),r=null}),$("#sample_2").on("click",".delete-row",function(e){e.preventDefault(),l&&r&&(i.fnDeleteRow(r),l=!1);var a=$(this).parents("tr")[0],t=a.cells,n=t[0].innerHTML,s=t[2].innerHTML,o=t[3].innerHTML;bootbox.confirm("Are you sure to delete this session?",function(e){e&&($.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> Deleting Record...'}),$.mockjax({url:"/tabledata/delete/webservice",dataType:"json",responseTime:1e3,responseText:{say:"ok"}}),$.ajax({url:"/tabledata/delete/webservice",dataType:"json",success:function(e){if($.unblockUI(),"ok"==e.say){if("true"==s||"true"==o)return alert("Current Session Or Admission session can't be deleted!"),!1;$.ajax({url:"deletesession",type:"POST",data:"sessionId="+n,success:function(e){i.fnDeleteRow(a),location.reload()},error:function(e){alert("Session already in use!")}})}}}))})}),$("#sample_2").on("click",".save-row",function(e){e.preventDefault();var a=$(this).parents("tr")[0];$.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> saving data...'}),$.mockjax({url:"/tabledata/add/webservice",dataType:"json",responseTime:1e3,responseText:{say:"ok"}}),$.ajax({url:"/tabledata/add/webservice",dataType:"json",success:function(e){$.unblockUI(),"ok"==e.say&&n(i,a)}})}),$("#sample_2").on("click",".save-edit-row",function(e){e.preventDefault();var a=$(this).parents("tr")[0];$.blockUI({message:'<i class="fa fa-spinner fa-spin"></i> saving data...'}),$.mockjax({url:"/tabledata/add/webservice",dataType:"json",responseTime:1e3,responseText:{say:"ok"}}),$.ajax({url:"/tabledata/add/webservice",dataType:"json",success:function(e){$.unblockUI(),"ok"==e.say&&s(i,a)}})}),$("#sample_2").on("click",".edit-row",function(a){a.preventDefault(),r&&(l?(i.fnDeleteRow(r),l=!1):e(i,r));var n=$(this).parents("tr")[0];t(i,n),r=n});var i=$("#sample_2").dataTable({aoColumnDefs:[{bSortable:!1,bSearchable:!1,aTargets:[0,-1,-2]}],oLanguage:{sLengthMenu:"Show _MENU_ Rows",sSearch:"",oPaginate:{sPrevious:"",sNext:""}},aaSorting:[[1,"asc"]],aLengthMenu:[[5,10,15,20,-1],[5,10,15,20,"All"]],iDisplayLength:10});$("#sample_2_wrapper .dataTables_filter input").addClass("form-control input-sm").attr("placeholder","Search"),$("#sample_2_wrapper .dataTables_length select").addClass("m-wrap small"),$("#sample_2_wrapper .dataTables_length select").select2(),$('#sample_2_column_toggler input[type="checkbox"]').change(function(){var e=parseInt($(this).attr("data-column")),a=i.fnSettings().aoColumns[e].bVisible;i.fnSetColumnVis(e,a?!1:!0)})};return{init:function(){e(),a()}}}();