function eventL(){window.eventList=[],$("#calendar").fullCalendar("removeEvents"),"select"!=$("#courseSelect").val()&&"select"!=$("#semOrYr").val()&&"select"!=$("#sessionSelect").val()&&("select"==$("#examDate33").val()&&getExamDates($("#courseSelect").val(),$("#sessionSelect").val(),$("#semOrYr").val()),$.ajax({url:"/sgterp/protected/dateSheetList?courseId="+$("#courseSelect").val()+"&sessionId="+$("#sessionSelect").val()+"&semOrYr="+$("#semOrYr").val()+"&examDate="+$("#examDate33").val(),type:"POST",success:function(e){var t=e.length;for(i=0;i<t;i++){titl="["+e[i].examName+":"+e[i].examId+"][MaxMarks:"+e[i].maxMarks+"]"+("YES"==$("#criteria").val()?"[MaxAssmntMarks:"+e[i].maxAssignMarks+"]":" ")+("Grade"==e[i].marksGrade?"[credit:"+e[i].credit+"]":" ");var a=new Date(e[i].startTime).getDay()+"";switch($("#ExamId").val(e[i].examId),a){case"0":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-red",allDay:!1};break;case"1":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-yellow",allDay:!1};break;case"2":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-green",allDay:!1};break;case"3":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-teal",allDay:!1};break;case"4":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-purple",allDay:!1};break;case"5":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-beige",allDay:!1};break;case"6":window.eventList[eventList.length]={title:titl,start:e[i].startTime,end:e[i].endTime,className:"label-orange",allDay:!1}}}$("#calendar").fullCalendar("addEventSource",eventList)},error:function(e){alert(JSON.stringify(e))}}))}function sessionList(){$.ajax({url:"/sgterp/protected/sessionlist",type:"GET",success:function(e){var t=JSON.parse(e),a=Object.keys(t).length/2,s=document.getElementById("sessionSelect");$("#sessionSelect").find("option").remove();var r=document.createElement("option");r.value="select",r.innerHTML="Select Session",r.selected="selected",s.appendChild(r);for(var l=0;a>l;l++){sessionId="sessionId"+l,value="value"+l;var n=document.createElement("option");n.value=t[sessionId],n.innerHTML=t[value],s.appendChild(n)}},error:function(e){alert(JSON.stringify(e))}})}function courseList(){$.ajax({url:"/sgterp/protected/courselist",type:"POST",success:function(e){var t=JSON.parse(e),a=Object.keys(t).length/7;semesterStore=t,semesterSize=a;var s=document.getElementById("courseSelect");$("#courseSelect").find("option").remove();var r=document.createElement("option");r.value="select",r.innerHTML="Select Course",r.selected="selected",s.appendChild(r);for(var l=0;a>l;l++){var n="courseId"+l,i="courseName"+l,c=document.createElement("option");c.value=t[n],c.innerHTML=t[i],s.appendChild(c)}},error:function(e){alert(JSON.stringify(e))}}),eventL()}function courseChange(e){var t=document.getElementById("semOrYr");$("#semOrYr").find("option").remove();var a=document.createElement("option");a.value="select",a.innerHTML="Select Sem/Yr",a.selected="selected",t.appendChild(a);for(var s,r,l=0;semesterSize>l;l++){var n="courseId"+l,i="courseDuration"+l;if(r="coursePattern"+l,e==semesterStore[n]){s=semesterStore[i];break}}for(var c=1;s>=c;c++){var o=document.createElement("option");o.value=c+" "+semesterStore[r],o.innerHTML=c+" "+semesterStore[r],t.appendChild(o)}eventL()}function getExamDates(e,t,a){"select"!=$("#courseSelect").val()&&"select"!=$("#semOrYr").val()&&"select"!=$("#sessionSelect").val()&&$.ajax({url:"/sgterp/protected/findExamDatesList?courseId="+e+"&sessionId="+t+"&semYear="+a,type:"POST",success:function(e){var t=e.length;for(i=0;i<t;i++)opt4=document.createElement("option"),opt4.value=e[i].examinationDateId,opt4.text=e[i].examDateRecordDetails,$("#grade").val(e[i].marksGrade),$("#criteria").val(e[i].examinationCrteria),examDate.add(opt4)},error:function(e){alert(e)}})}function changeValue(){examDate=document.getElementById("examDate33"),examDate.options.length=0,opt3=document.createElement("option"),opt3.value="select",opt3.text="Select...",examDate.add(opt3),$("#examDate33").select2("val","select")}var eventList=[],Calendar=function(){var e=function(){var e=$("#event-management");$("#event-categories div.event-category").each(function(){var e={title:$.trim($(this).text())};$(this).data("eventObject",e),$(this).draggable({zIndex:999,revert:!0,revertDuration:50})});var t=new Date,a=(t.getDate(),t.getMonth(),t.getFullYear(),""),s=$("#calendar").fullCalendar({buttonText:{prev:'<i class="fa fa-chevron-left"></i>',next:'<i class="fa fa-chevron-right"></i>'},header:{left:"prev next today",center:"title",right:"month,agendaWeek,agendaDay"},events:eventList,editable:!0,droppable:!0,drop:function(e,t){var a=$(this).data("eventObject"),s=$(this).attr("data-class"),r=$.extend({},a);r.start=e,r.allDay=t,s&&(r.className=[s]),$("#calendar").fullCalendar("renderEvent",r,!0),$("#drop-remove").is(":checked")&&$(this).remove()},selectable:!0,selectHelper:!0,select:function(t,r,l){return"select"==$("#courseSelect").val()?(alert("Please Select Value First"),void $("#courseSelect").focus()):"select"==$("#semOrYr").val()?(alert("Please Select Value First"),$("#calendar").fullCalendar("removeEvents"),void $("#semOrYr").focus()):"select"==$("#examDate33").val()?(alert("Please Select Value First"),$("#calendar").fullCalendar("removeEvents"),void $("#examDate33").focus()):"select"==$("#sessionSelect").val()?(alert("Please Select Value First"),$("#calendar").fullCalendar("removeEvents"),void $("#sessionSelect").focus()):(e.modal({backdrop:"static"}),a=$("<form action='/sgterp/protected/classSchedule' mehtod='post'></form>"),a.append("<div class='row'></div>"),a.find(".row").append("<div class='col-md-12'><div class='form-group'><label class='control-label'>Select Subject&emsp;</label><select id = subject class='form-control'   name='title'><option selected='selected' value=''>Select</option></select></div></div><div class='col-md-6'><div class='form-group'><label class='control-label'>Max Marks&emsp;</label><input required='true' value='0' type='text' id ='maxMark' class='form-control number-key-only' maxlength='3' name='maxMarks' onkeypress='numeric(event);'></div></div>"),"YES"==$("#criteria").val()&&a.find(".row").append("<div class='col-md-6'><div class='form-group'><label class='control-label'>Max Assignment Marks&emsp;</label><input required type='text' value='0' id ='maxAssignmentMarks' class='form-control number-key-only' maxlength='3' name='maxAssignmentMarks ' onkeypress='numeric(event);'></div></div>"),"Grade"==$("#grade").val()&&a.find(".row").append("<div class='col-md-6' id='creditMarksDiv'><div class='form-group'><label class='control-label'>Credit&emsp;</label><input required type='text' value='0' id ='credits' class='form-control number-key-only' maxlength='3' name='creditMarks ' onkeypress='numeric(event);'></div></div>"),$.ajax({url:"/sgterp/protected/scheduleSujectList?courseId="+$("#courseSelect").val()+"&semOrYr="+$("#semOrYr").val(),type:"GET",success:function(e){var t=JSON.parse(e),a=Object.keys(t).length/2,s=document.getElementById("subject");$("#subject").find("option").remove();var r=document.createElement("option");r.value="",r.innerHTML="Select Subject",r.selected="selected",s.appendChild(r);for(var l=0;a>l;l++){subjectId="subjectId"+l,subjectName="subjectName"+l;var n=document.createElement("option");n.value=t[subjectId],n.innerHTML=t[subjectName],s.appendChild(n)}},error:function(e){alert(JSON.stringify(e))}}),e.find(".remove-event").hide().end().find(".save-event").show().end().find(".modal-body").empty().prepend(a).end().find(".save-event").unbind("click").click(function(){return""==$("#subject").val()?(alert("select subject"),$("#subject").focus(),!1):""==$("#maxMark").val()||0==$("#maxMark").val()?(alert("Enter Max Marks"),$("#maxMark").focus(),!1):""==$("#maxAssignmentMarks").val()||0==$("#maxAssignmentMarks").val()?(alert("Enter Max AssignmentMarks"),$("#credits").focus(),!1):""==$("#credits").val()||0==$("#credits").val()?(alert("Enter Credits"),$("#credits").focus(),!1):($.ajax({url:"/sgterp/protected/administrator/examDateSheetSave?examId1="+$("#ExamId").val(),type:"POST",data:"subjectId="+$("#subject").val()+"&maxMarks="+$("#maxMark").val()+"&creditMarks="+$("#credits").val()+"&maxAssignmentMarks="+$("#maxAssignmentMarks").val()+"&startTime="+t+"&sessionId="+$("#sessionSelect").val()+"&courseId="+$("#courseSelect").val()+"&examinationDate="+$("#examDate33").val()+"&semYear="+$("#semOrYr").val()+"&endTime="+r,success:function(e){"alreadyExist"==e&&alert("Date Sheet Already Exist for this Exam !"),eventL(),"failure"==e&&alert("Exam of same course can not be sechduled on this day")},error:function(e){alert("Please Select Subject First")}}),void e.modal("hide"))}),e.find("form").on("submit",function(){return title=a.find("input[name='title']").val(),$categoryClass=a.find("select[name='category'] option:checked").val(),null!==title&&s.fullCalendar("renderEvent",{title:title,start:t,end:r,allDay:l,className:$categoryClass},!0),e.modal("hide"),!1}),void s.fullCalendar("unselect"))},eventClick:function(t,a,r){var l=t.title.match(/[^\[\]]+/g),n=l[0].split(":"),i=l[1].split(":"),c=l[2].split(":"),o=l[3].split(":"),d=$("<form></form>");d.append("<div class='row'></div>"),d.append("<label>Change Subject</label>"),d.append("<div class='input-group'><select required id = subject class='form-control' name='title' ><option selected='selected' value=''>Select</option></select><span class='input-group-btn'><button type='submit' class='btn btn-success'><i class='fa fa-check'></i> Save</button></span></div><div class='col-md-6' style='margin-top:2%'><div class='form-group'><label class='control-label'>Max Marks&emsp;</label><input required='true' value="+i[1]+" type='text' id ='maxMark1' class='form-control number-key-only' maxlength='3' name='maxMarks1' onkeypress='numeric(event);'></div></div>"),"YES"==$("#criteria").val()&&d.append("<div class='col-md-6' style='margin-top:2%'><div class='form-group'><label class='control-label'>Max Assignment Marks&emsp;</label><input required type='text' value="+c[1]+" id ='maxAssignmentMarks1' class='form-control number-key-only' maxlength='3' name='maxAssignmentMarks1' onkeypress='numeric(event);'></div></div>&nbsp;"),"Grade"==$("#grade").val()&&d.append("<div class='col-md-6' style='margin-top:2%' id='creditMarksDiv'><div class='form-group'><label class='control-label'>Credit&emsp;</label><input required type='text' value="+o[1]+" id ='credits1' class='form-control number-key-only' maxlength='3' name='creditMarks' onkeypress='numeric(event);'></div></div>"),$.ajax({url:"/sgterp/protected/scheduleSujectList?courseId="+$("#courseSelect").val()+"&semOrYr="+$("#semOrYr").val(),type:"GET",success:function(e){var t=JSON.parse(e),a=Object.keys(t).length/2,s=document.getElementById("subject");$("#subject").find("option").remove();var r=document.createElement("option");r.value="",r.innerHTML="Select Subject",s.appendChild(r);for(var l=0;a>l;l++){subjectId="subjectId"+l,subjectName="subjectName"+l;var i=document.createElement("option");i.value=t[subjectId],i.innerHTML=t[subjectName],t[subjectName]==n[0]&&(i.selected="selected"),s.appendChild(i)}},error:function(e){alert(JSON.stringify(e))}}),e.modal({backdrop:"static"}),e.find(".remove-event").show().end().find(".save-event").hide().end().find(".modal-body").empty().prepend(d).end().find(".remove-event").unbind("click").click(function(){$.ajax({url:"/sgterp/protected/dateSheetDelete",type:"POST",data:"examId="+n[1],success:function(e){"success"==e?s.fullCalendar("removeEvents",function(e){return e._id==t._id}):alert("Already in use,Can not Delete")},error:function(e){alert("Internal Server Error")}}),e.modal("hide")}),e.find("form").on("submit",function(){return $.ajax({url:"/sgterp/protected/dateSheetUpdate?examId="+n[1]+"&subjectId="+$("#subject").val()+"&creditMarks="+$("#credits1").val()+"&maxMark1="+$("#maxMark1").val()+"&maxAssignmentMarks1="+$("#maxAssignmentMarks1").val(),type:"GET",success:function(e){"alreadyExist"==e&&alert("Date Sheet Already Exist for this Exam !"),eventL()},error:function(e){alert("Internal Server Error")}}),e.modal("hide"),!1})}})};return{init:function(){e()}}}(),semesterStore,semesterSize;