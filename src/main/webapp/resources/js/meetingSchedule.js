function eventL(){window.eventList=[],$("#calendar").fullCalendar("removeEvents"),$.ajax({url:"/sgterp/protected/meetingScheduleList",type:"POST",success:function(e){for(meetingScheduleList=e,i=0;i<e.length;i++)titl=e[i].title+"["+e[i].scheduleId+"]",startDateTime=new Date(e[i].startDate),endDateTime=new Date(e[i].endDate),window.eventList[eventList.length]={title:titl,start:startDateTime,end:endDateTime,className:"label-blue",allDay:!1};$("#calendar").fullCalendar("addEventSource",eventList)},error:function(e){alert("Internal server problem!")}})}var eventList=[],meetingScheduleList,Calendar=function(){var e=function(){var e=$("#event-management");$("#event-categories div.event-category").each(function(){var e={title:$.trim($(this).text())};$(this).data("eventObject",e),$(this).draggable({zIndex:999,revert:!0,revertDuration:50})});var t=new Date,n=(t.getDate(),t.getMonth(),t.getFullYear(),""),a=$("#calendar").fullCalendar({buttonText:{prev:'<i class="fa fa-chevron-left"></i>',next:'<i class="fa fa-chevron-right"></i>'},header:{left:"prev next today",center:"title",right:"month,agendaWeek,agendaDay"},events:eventList,editable:!1,droppable:!0,drop:function(e,t){var n=$(this).data("eventObject"),a=$(this).attr("data-class"),i=$.extend({},n);i.start=e,i.allDay=t,a&&(i.className=[a]),$("#calendar").fullCalendar("renderEvent",i,!1),$("#drop-remove").is(":checked")&&$(this).remove()},selectable:!0,selectHelper:!0,select:function(t,i,r){var l=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getMilliseconds(),d=i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getMilliseconds();$("#startDate").data("daterangepicker").setStartDate(l),$("#startDate").data("daterangepicker").setEndDate(d),e.modal({backdrop:"static"}),e.find(".remove-event").hide().end().find(".save-event").show().end().find(".save-event").unbind("click").click(function(){$.ajax({url:"/sgterp/protected/addMeetingSchedule",type:"POST",data:$("#meetingScheduleForm").serialize(),success:function(e){eventL()},error:function(e){alert("Internal server problem!"+JSON.stringify(e))}}),e.modal("hide"),$(".for-empty").val(""),$("#repeat").val("0"),$("#untilDiv").hide(),$("#until").datepicker("setDate",new Date),hideEditor()}),e.find("form").on("submit",function(){return title=n.find("input[name='title']").val(),$categoryClass=n.find("select[name='category'] option:checked").val(),null!==title&&a.fullCalendar("renderEvent",{title:title,start:t,end:i,allDay:r,className:$categoryClass},!0),e.modal("hide"),$(".for-empty").val(""),$("#repeat").val("0"),$("#untilDiv").hide(),hideEditor(),$("#until").datepicker("setDate",new Date),!1}),a.fullCalendar("unselect")},eventClick:function(t,n,i){for(var r=t.title.indexOf("[")+1,l="";r<t.title.indexOf("]");)l+=t.title[r],r++;for(var d=0;d<meetingScheduleList.length;d++)meetingScheduleList[d].scheduleId==l&&($("#meetingScheduleId").val(meetingScheduleList[d].scheduleId),$("#title").val(meetingScheduleList[d].title),$("#description").val(meetingScheduleList[d].description),$("#location").val(meetingScheduleList[d].location),$("#repeat").val("0"),$("#untilDiv").hide(),$("#until").datepicker("setDate",new Date),""!=meetingScheduleList[d].minutesOfMeeting&&($("#minutesOfMeeting").code(meetingScheduleList[d].minutesOfMeeting),$("#minutesCheckBox").prop("checked",!0),showMinutesDiv(!0)),$("#startDate").data("daterangepicker").setStartDate(meetingScheduleList[d].startDateCopy),$("#startDate").data("daterangepicker").setEndDate(meetingScheduleList[d].endDateCopy));e.modal({backdrop:"static"}),e.find(".remove-event").show().end().find(".save-event").show().end().find(".remove-event").unbind("click").click(function(){$.ajax({url:"/sgterp/protected/deleteMeetingSchedule",type:"POST",data:"meetingScheduleId="+l,success:function(e){a.fullCalendar("removeEvents",function(e){return e._id==t._id})},error:function(e){alert("Internal server problem!")}}),e.modal("hide"),$(".for-empty").val(""),$("#repeat").val("0"),$("#untilDiv").hide(),hideEditor(),$("#until").datepicker("setDate",new Date)}),e.find("form").on("submit",function(){return $.ajax({url:"/sgterp/protected/addMeetingSchedule",type:"POST",data:$("#meetingScheduleForm").serialize()+"&minutesOfMeeting="+$("#minutesOfMeeting").code(),success:function(e){eventL()},error:function(e){alert("Internal server problem!")}}),e.modal("hide"),$(".for-empty").val(""),$("#repeat").val("0"),$("#untilDiv").hide(),hideEditor(),$("#until").datepicker("setDate",new Date),!1})}})};return{init:function(){e()}}}();